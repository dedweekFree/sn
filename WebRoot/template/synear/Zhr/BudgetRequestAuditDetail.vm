<html>
<head>
<title>======</title>
<link rel="stylesheet" type="text/css" href="../../../js/ZhrCss.css">
<link rel="stylesheet" type="text/css" href="../../../js/spellCode.css">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<script src="../../../js/sunnyfunc.js"></script>
<script src="../../../js/string.js"></script>
<script>
var undefined;

function init(){
  uniteCols(document.all.tb);//执行
}

function uniteTable(thistab,colLength){   
  var   rn=thistab.rows.length;//取得行数   
  var   rowspann=0;   
  for(j=colLength-1;j>=0;j--){//从第0列开始，合并多少列   
    for(i=rn-1;i>0;i--){//从倒数第一行开始往上检查   
      if(thistab.rows[i].cells[j].innerText==thistab.rows[i-1].cells[j].innerText&&thistab.rows[i].cells[j].colSpan==thistab.rows[i-1].cells[j].colSpan){//与上面一行比较，如果两行相等就合计当前行的合并行数，并删除当前行。   
        rowspann+=thistab.rows[i].cells[j].rowSpan;   
        thistab.rows[i].deleteCell(j);   
      }else{   
        thistab.rows[i].cells[j].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。   
        rowspann=0;   
      }   
    }   
    //检测无表头的表   
    if(i==0&&rowspann>0){   
      thistab.rows[i].cells[j].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。   
      rowspann=0;   
    }   
    
  }   
}  
//本业务合并
function uniteCols(thistab){   
  var   rn=thistab.rows.length;//取得行数   
  var   rowspann=0;   
  for(i=rn-1;i>0;i--){//从倒数第一行开始往上检查   
      if(thistab.rows[i].cells[0].innerText==thistab.rows[i-1].cells[0].innerText&&thistab.rows[i].cells[0].colSpan==thistab.rows[i-1].cells[0].colSpan){//与上面一行比较，如果两行相等就合计当前行的合并行数，并删除当前行。   
        rowspann+=thistab.rows[i].cells[0].rowSpan;  
        thistab.rows[i].deleteCell(18);
	thistab.rows[i].deleteCell(17);
        thistab.rows[i].deleteCell(16); 
        thistab.rows[i].deleteCell(15);  
	//thistab.rows[i].deleteCell(14);
	//thistab.rows[i].deleteCell(13);
	thistab.rows[i].deleteCell(11);
	thistab.rows[i].deleteCell(10);
        thistab.rows[i].deleteCell(9);  
	thistab.rows[i].deleteCell(8);
	thistab.rows[i].deleteCell(2);
	thistab.rows[i].deleteCell(0);
      }else{   
        thistab.rows[i].cells[0].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。
	thistab.rows[i].cells[2].rowSpan+=rowspann;
	thistab.rows[i].cells[8].rowSpan+=rowspann;
	thistab.rows[i].cells[9].rowSpan+=rowspann;
	thistab.rows[i].cells[10].rowSpan+=rowspann;
	thistab.rows[i].cells[11].rowSpan+=rowspann;
	//thistab.rows[i].cells[13].rowSpan+=rowspann;
	//thistab.rows[i].cells[14].rowSpan+=rowspann;
	thistab.rows[i].cells[15].rowSpan+=rowspann;
	thistab.rows[i].cells[16].rowSpan+=rowspann;
	thistab.rows[i].cells[17].rowSpan+=rowspann;
	thistab.rows[i].cells[18].rowSpan+=rowspann;
        rowspann=0;   
      }   
  }   
  //检测无表头的表   
  if(i==0&&rowspann>0){   
        thistab.rows[i].cells[0].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。
	thistab.rows[i].cells[2].rowSpan+=rowspann;
	thistab.rows[i].cells[8].rowSpan+=rowspann;
	thistab.rows[i].cells[9].rowSpan+=rowspann;
	thistab.rows[i].cells[10].rowSpan+=rowspann;
	thistab.rows[i].cells[11].rowSpan+=rowspann;
	
	//thistab.rows[i].cells[13].rowSpan+=rowspann;
	//thistab.rows[i].cells[14].rowSpan+=rowspann;
	thistab.rows[i].cells[15].rowSpan+=rowspann;
	thistab.rows[i].cells[16].rowSpan+=rowspann;
	thistab.rows[i].cells[17].rowSpan+=rowspann;
	thistab.rows[i].cells[18].rowSpan+=rowspann;
      rowspann=0;   
  }   
} 

function setvalue(step,status){
  document.form1.step.value=step;
  document.form1.status.value=status;
  document.form1.submit();
}
function OpenEdit(a,b,c,d,e,f){
    //location.href='BudgetRequestAuditEdit.aspx?applymonth='+a+'&custpk='+b;
     location.href='BudgetRequestAuditEdit.aspx?applymonth='+a+'&custpk='+b+'&areacode='+c+'&status='+d+'&step='+e+'&flow='+f;
    //var ReturnProductValue=showModalDialog('BudgetRequestAuditEdit.aspx?applymonth='+a+'&custpk='+b,'','dialogWidth:750px;dialogHeight:550px;dialogLeft:280px;dialogTop:150px;center:yes; help:yes;resizable:yes;status:yes');
    //location.reload();
}
function OpenEdit2(a){
    var ReturnProductValue=showModalDialog('BudgetAuthorizeRequestAuditLog.aspx?id='+a,'','dialogWidth:750px;dialogHeight:550px;dialogLeft:280px;dialogTop:150px;center:yes; help:yes;resizable:yes;status:yes');
}
</script>

</head>
<body onload="init()">
    <div class="Main">
        <div class="CaptionTxt">费用申请表</div>
<table class="List">
<tr><td height="30">$!form_applymonth 费用申请清单</td></tr>
</table>

<table id="tb"  class="List">
  <tr class="trtitle" bgcolor="abcdef">
    <th width="18%" height="25" nowrap>客户名称</th>
    <th width="8%" height="25" nowrap>销售</th>
    <th width="8%" height="25" nowrap>回款</th>
    <th width="8%" height="25" nowrap>部门</th>
    <th width="8%" height="25" nowrap>产品类别</th>
    <th width="8%" height="25" nowrap>预算产品费用</th>
    <th width="8%" height="25" nowrap>其他费用</th>
    <th width="8%" height="25" nowrap>说明</th>
    <th width="8%" height="25" nowrap>预算销售</th>
    <th width="8%" height="25" nowrap>预算应收</th>
    <th width="8%" height="25" nowrap>预算其它</th>
    
    <th width="8%" height="25" nowrap>预算费用合计</th>
    <th width="8%" height="25" nowrap>申报产品费用</th>
    <th width="8%" height="25" nowrap>申报其他费用</th>
    <th width="8%" height="25" nowrap>说明</th>
    <th width="8%" height="25" nowrap>申报销售</th>
    <th width="8%" height="25" nowrap>申报应收</th>
    <th width="8%" height="25" nowrap>申报其它</th>
    
    <th width="8%" height="25" nowrap>申报费用合计</th>
  </tr>
 #set($i=0)
 #foreach($m in $ZhrFeeRequestListAuditDetail)
  <tr class="trcolor">
      <td align="center" nowrap>
      
      $!m.CUSTNAME<br><font class="FontButton" onclick="OpenEdit('$!m.APPLYMONTH','$!m.NC_CUST_PK','$!form_areacode','$!form_status','$!form_step','$!form_flow');">修改</font>&nbsp&nbsp<font class="FontButton"  onclick="OpenEdit2('$!m.FEEID');">记录($!m.AUDITNUM)</font>
      
      </td>
      <td align="center" nowrap>$!m.NMNY</td>
      <td align="center" nowrap>$!m.CASH</td>
      <td align="center" nowrap>$!m.DEPTNAME</td>
      <td align="center" nowrap>$!m.INVCLASSNAME</td>
       <td align="center" nowrap>
	#if($m.DEPETSUBJECT=="20091014132016001"||$m.DEPETSUBJECT=="20091014132016002")
	$!m.PRE_PRODFEE
	#end
	</td>
       <td align="center" nowrap>
	#if($m.DEPETSUBJECT!="20091014132016001"&&$m.DEPETSUBJECT!="20091014132016002")
	$!m.PRE_PRODFEE
	#end
	</td>
        <td align="center" nowrap>$!m.REMARK &nbsp;</td>
      <td align="center" nowrap>$!m.PRE_SALEAIM</td>
      <td align="center" nowrap>$!m.PRE_RECEVALAIM</td>
       <td align="center" nowrap>$!m.PRE_ORTHERAIM</td>
       
        <td align="center" nowrap>$!m.PRE_ALLFEE</td>
       <td align="center" nowrap>
       	#if($m.DEPETSUBJECT=="20091014132016001"||$m.DEPETSUBJECT=="20091014132016002")
       $!m.PRE_PRODFEE2
       #end
       </td>
       <td align="center" nowrap>
       	#if($m.DEPETSUBJECT!="20091014132016001"&&$m.DEPETSUBJECT!="20091014132016002")
	$!m.PRE_PRODFEE2
	#end
	</td>
        <td align="center" nowrap>$!m.REMARK2 &nbsp;</td>
           <td align="center" nowrap>$!m.PRE_SALEAIM2</td>
      <td align="center" nowrap>$!m.PRE_RECEVALAIM2</td>
       <td align="center" nowrap>$!m.PRE_ORTHERAIM2</td>
       
        <td align="center" nowrap>$!m.PRE_ALLFEE2</td>
 </tr>
  #set($i=$i+1)
 #end
 #foreach($m in $ZhrFeeRequestDetialTotal)
  <tr class="trcolor">
      <td align="center" nowrap>合计</td>
      <td align="center" nowrap>&nbsp;</td>
      <td align="center" nowrap>&nbsp;</td>
      <td align="center" nowrap>&nbsp;</td>
      <td align="center" nowrap>&nbsp;</td>
       <td align="center" nowrap>$!m.PRE_PRODFEE</td>
        <td align="center" nowrap>&nbsp;</td>
	<td align="center" nowrap>&nbsp;</td>
        <td align="center" nowrap>$!m.PRE_SALEAIM</td>
      <td align="center" nowrap>$!m.PRE_RECEVALAIM</td>
       <td align="center" nowrap>$!m.PRE_ORTHERAIM</td>
       
        <td align="center" nowrap>$!m.PRE_ALLFEE</td>
       <td align="center" nowrap>$!m.PRE_PRODFEE2</td>
        <td align="center" nowrap>&nbsp;</td>
        <td align="center" nowrap>&nbsp;</td>
      
        <td align="center" nowrap>$!m.PRE_SALEAIM2</td>
      <td align="center" nowrap>$!m.PRE_RECEVALAIM2</td>
       <td align="center" nowrap>$!m.PRE_ORTHERAIM2</td>
       
        <td align="center" nowrap>$!m.PRE_ALLFEE2</td>
 </tr>
 #end
  </table>
  <br>
  <div align="center">审核记录</div>
  <table class="List">
  <tr class="trtitle" bgcolor="abcdef">
    <th width="8%" height="25" nowrap>审核时间</th>
    <th width="8%" height="25" nowrap>审核人</th>
    <th width="8%" height="25" nowrap>审核结果</th>
    <th width="58%" height="25" nowrap>审核意见</th>
  </tr>
 #foreach($m in $getAudiRemark)
  <tr class="trcolor">
      <td align="center" nowrap>$!m.AUDIDATE</td>
      <td align="center" nowrap>$!m.NAME</td>
      <td align="center" nowrap><script>'$!m.AUDISTATUS'.toRealText('F','同意','不同意').write()</script></td>
      <td align="center" nowrap>$!m.REMARK &nbsp;</td>
 </tr>
 #end
  </table>
<form name="form1" method='post' action="BudgetRequestAuditSubmit.aspx" target="dataframe">  
  <input name="applymonth" type="hidden" value="$!form_applymonth">
  <input name="username" type="hidden" value="$!form_username">
  <input name="areacode" type="hidden" value="$!form_areacode">
  <input name="step" type="hidden" value="1">
  <input name="oldstep" type="hidden" value="$!form_step">
  <input name="status" type="hidden" value="F">
 #if($form_step==0)
 #else
  <div align="center">
  审核意见：<textarea name="remark" cols="120" rows="3"></textarea>
  </div>
 #end 
</form>

<form name="form2" method='post' action="editareafeerequest.aspx">  
  <input name="applymonth" type="hidden" value="$!form_applymonth">
  <input name="custpk" type="hidden" value="$!form_custpk">
</form>

 <div class="Control">
 #if($form_step==0)
    
 #elseif($form_step=="")
 #else
    <input type="button" class="login2" value=" 通  过 " name="B222" onClick="javascript:setvalue('1','F');">&nbsp;&nbsp;&nbsp;&nbsp;
    <input type="button" class="login2" value=" 退  回 " name="B222" onClick="javascript:setvalue('-1','R');">&nbsp;&nbsp;&nbsp;&nbsp;
 #end   
<input type="button" class="login2" value=" 返  回 " name="B222" onClick="javascript:location.href='BudgetRequestAudit.aspx'">
  </div>
<iframe name="dataframe" src="" width="0" height="0"></iframe>
</div>
</body> 
</html>      
