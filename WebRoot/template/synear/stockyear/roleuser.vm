<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<link rel="stylesheet" type="text/css" href="../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../js/spellCode.css">
<script src="../../inc/js/alai_win_xp.js" language="javascript"></script>
<title></title>
<script>
	function dd(){
		document.all.aaa.value='1';
	}
</script>
<script>
	function m(){
		var f = document.all.userid.value;
		document.all.del_userid.value = f;
		del_user.submit();
	}
</script>
<script>
	var sellist = new Array();
		sellist = [['序号','大区','区域','用户名','用户姓名','角色','用户ID','角色ID','大区主键','区域主键']
		#set($i=1)
		#foreach($!m in $queryhruserinfo)
		,['$i','$m.BIGAREA','$m.DEPTNAME','$m.USERNAME','$m.NAME','$m.ROLENAME','$m.USERID','$m.ROLEID','$m.BIG_PK','$m.NC_PK']
		#set($i=$i+1)
		#end
		]
	var pageSize=20;
	var pageno=0;
	var rdata=new Array();
	rdata=sellist;
function toPage2(){
  var element=document.all.pgs;
  if(element.value.search("^-?\\d+(\\.\\d+)?$")!=0){
     alert("页数必须为大于1且小于"+Math.ceil((rdata.length-1)/pageSize)+"的整数!");
     element.focus();
     return false;
  }
  if(element.value<1){
     alert("页数必须为大于1且小于"+Math.ceil((rdata.length-1)/pageSize)+"的整数!");
     element.focus();
     return false;
  }
  if(element.value>Math.ceil((rdata.length-1)/pageSize)){
     alert("页数必须为大于1且小于"+Math.ceil((rdata.length-1)/pageSize)+"的整数!");
     element.focus();
     return false;
  }
  toPage(element.value) 
}
function toPage(page){
try{
  pageno=page;
  for(var i=tab.rows.length;i>1;i--) tab.deleteRow(i-1);
  for(var i=1;i<=pageSize;i++){
    if(((page-1)*pageSize+i)<rdata.length){
  	  var row=tab.insertRow()
	  row.insertCell().innerText=rdata[(page-1)*pageSize+i][0]
	  row.insertCell().innerText=rdata[(page-1)*pageSize+i][3]
	  row.insertCell().innerText=rdata[(page-1)*pageSize+i][4]
	  row.insertCell().innerText=rdata[(page-1)*pageSize+i][5]
	  if(rdata[(page-1)*pageSize+i][5].indexOf("在职") != -1){
	     row.insertCell().innerHTML="<a href='#' onclick=tolizhi('addrolesub.aspx?roleid=R3985&userid="+rdata[(page-1)*pageSize+i][6]+"') >离职</a>";
	  }else{
	     row.insertCell().innerHTML="&nbsp;";
	  }
    }
 }
 var apg=Math.ceil((rdata.length-1)/pageSize);
 var npg=parseInt(page)+1;
 var ppg=parseInt(page)-1;
 var pagetext="共<font color=red>"+apg+"</font>页<font color=red>"+(rdata.length-1)+"</font>条记录，每页显示<font color=red>"+pageSize+"</font>条，目前是第<font color=red>"+page+"</font>页&nbsp;&nbsp;&nbsp;&nbsp;";
 if(page<apg) pagetext+="<a style='cursor:hand' onclick='toPage2()'><font color=blue>转到</font></a><input type=text id=pgs size=3 value="+npg+">&nbsp;&nbsp;&nbsp;&nbsp;";
 else  pagetext+="<a style='cursor:hand' onclick='toPage2()'><font color=blue>转到</font></a><input type=text id=pgs size=3 value=1>&nbsp;&nbsp;&nbsp;&nbsp;";
 if(page>1) pagetext+="<a style='cursor:hand' onclick='toPage(1)'><font color=blue>首页</font></a>&nbsp;&nbsp;<a style='cursor:hand' onclick='toPage("+ppg+")'><font color=blue>上一页</font></a>&nbsp;&nbsp;"
 if(page<apg) pagetext+="<a style='cursor:hand' onclick='toPage("+npg+")'><font color=blue>下一页</font></a>&nbsp;&nbsp;<a style='cursor:hand' onclick='toPage("+apg+")'><font color=blue>尾页</font></a>&nbsp;&nbsp;"
 
 document.all.pg.innerHTML=pagetext;
 }catch(e){
   alert(e.description)
 }
}
function tolizhi(url){
  if(confirm("确认要离职吗？")){
      form_submit.action = url;
      form_submit.submit();
  }
}
</script>
</head>
<body >
<form name='form1' action='roleuser.aspx' method='post'>
<table class="datatable">
  <tr class="trcolor">
    <td>用户名:
        <input type="text" name="username" value="$!form_username"/>
    </td>
    <td>用户姓名:
          <input type="text" name="name" value="$!form_name"/>
          </td>
        <td>角色:&nbsp;&nbsp;
	<select name='roleid'>
	<option value=''>请选择角色</option>
	<option value='离职' #if($!form_roleid == '离职')selected#end>离职</option>
	<option value='在职' #if($!form_roleid == '在职')selected#end>在职</option>
	</select>
    </td>
  </tr>
  <tr class="trcolor">
    <td>
      <input type="submit" name="button" value="查询用户" onclick='dd()'/>
    </td>
    <td>
      &nbsp;
    </td>
    <td>&nbsp;</td>
  </tr>
</table>
</form>
<br>
<table class="datatable" id='tab'>
  <tr class="trcolor">
    <td>序号</td>
    <td>用户名</td>
    <td>用户姓名</td>
    <td>角色</td>
    <td>操作</td>
  </tr>
</table>
<span id="pg"></span>
<script>
	 toPage(1);
</script>
<form name='form_submit' method='post'>
</form>
</body>
</html>