

<html>
<head>
<link rel="stylesheet" type="text/css" href="../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../js/spellCode.css">
<meta http-equiv="Content-Type" content="text/html; charset=GBK">
<script type="text/javascript" src="../../../inc/js/array2.js"></script>
<title>计划产量月报表</title>
<style type="text/css">
table {
border: #a4cdf2 1px solid;
}
td {
bor
der: #a4cdf2 1px solid;
font-family: "courier new";
font-size: 11pt;
}
td.locked {
position: relative;
left: expression(document.getElementById("divTableContainer").scrollLeft + "px");
background-color: #ffff82;
}
</style>
</head>
<script type="text/javascript">

function showTotal()
{
   var rowtotal=datatable.rows.length;
   var coltotal=datatable.rows[0].cells.length
   var str=0;
   for(var i=1;i<rowtotal-1;i++)
   {
            str=0;
	    str = str + parseInt(datatable.rows(i).cells(8).innerText) + parseInt(datatable.rows(i).cells(6).innerText) - parseInt(datatable.rows(i).cells(4).innerText);
	    datatable.rows(i).cells(3).innerText = str;
   }
   for(var j=3;j<coltotal;j++)
   {
      str=0;
      for(var i=1;i<rowtotal-1;i++)
	  {
	     str = str + parseInt(datatable.rows(i).cells(j).innerText);
	  }

      datatable.rows(rowtotal-1).cells(j).innerText = str;
   }
}
</script>

<body>
<!--overflow-x: scroll; -->
<div class="qx" style="text-align:left">月份：$form_mn &nbsp;&nbsp;&nbsp;&nbsp;
生产分厂/班组：$!form_facname  #if($form_stor=='10')A#elseif($form_stor=='20')B#elseif($form_stor=='30')C#elseif($form_stor=='40')D#end</div>
<div id="divTableContainer" style="width: 100%; ">
<table class="datatable" border="0" cellpadding="0" frame=box id="datatable"
		cellspacing="0">
	<tr class="search">
		<td nowrap width="auto">分类</td>		
		<td nowrap >规格系列</td>
		<td nowrap width="auto">产品名称</td>
		<td nowrap >规格</td>	
		<td nowrap>单件重量</td>	
		<td nowrap width="50">1日</td>
		<td nowrap width="50">2日</td>	
		<td width="50" nowrap>3日</td>
		<td width="50" nowrap>4日</td>
		<td width="50" nowrap>5日</td>
		<td width="50" nowrap>6日</td>
		<td width="50" nowrap>7日</td>
		<td width="50" nowrap>8日</td>
		<td width="50" nowrap>9日</td>
		<td width="50" scroll>10日</td>
		<td width="50" scroll>11日</td>
		<td width="50" scroll>12日</td>
		<td width="50" scroll>13日</td>
		<td width="50" scroll>14日</td>
		<td width="50" scroll>15日</td>
		<td width="50" scroll>16日</td>
		<td width="50" scroll>17日</td>
		<td width="50" scroll>18日</td>
		<td width="50" scroll>19日</td>
		<td width="50" scroll>20日</td>
		<td width="50" scroll>21日</td>
		<td width="50" scroll>22日</td>
		<td width="50" scroll>23日</td>
		<td width="50" scroll>24日</td>
		<td width="50" scroll>25日</td>
		<td width="50" scroll>26日</td>
		<td width="50" scroll>27日</td>
		<td width="50" scroll>28日</td>
		<td width="50" scroll>29日</td>
		<td width="50" scroll>30日</td>
		<td width="50" scroll>31日</td>
		<td >合计</td>
	</tr>

    #foreach($k in $sql0)
	<tr class="trcolor NUM">
		<td class="CN">$k.INVCLASSNAME</td>
		<td class="NUM">$k.SPEC</td>
		<td>$k.INVNAME</td>
                 <td >$k.INVTYPE</td>	
		<td >$k.UNITWEIGHT</td>	
			<td>$k.D1</td>
                <td>$k.D2</td>			
		<td>$k.D3</td>
                <td>$k.D4</td>
		<td>$k.D5</td>
		<td>$k.D6</td>
		<td>$k.D7</td>
		<td>$k.D8</td>
		<td>$k.D9</td>
		<td>$k.D10</td>
		<td>$k.D11</td>
		<td>$k.D12</td>
		<td>$k.D13</td>
		<td>$k.D14</td>
		<td>$k.D15</td>
		<td>$k.D16</td>
		<td>$k.D17</td>
		<td>$k.D18</td>
		<td>$k.D19</td>
		<td>$k.D20</td>
		<td>$k.D21</td>
		<td>$k.D22</td>
		<td>$k.D23</td>
		<td>$k.D24</td>
		<td>$k.D25</td>
		<td>$k.D26</td>
		<td>$k.D27</td>
		<td>$k.D28</td>
		<td>$k.D29</td>
		<td>$k.D30</td>
		<td>$k.D31</td>
		<td>$k.SNUM</td>

	</tr>
   #end

</table>
</div>
<script type="text/javascript">
<!--
/*
var oTable = document.getElementById("datatable");
var lockedCellIndex = -1;
for (var i=0; i<oTable.rows[0].cells.length; i++)
{
oTable.rows[0].cells[i].originalCellIndex = oTable.rows[0].cells[i].cellIndex;





oTable.rows[0].cells[i].onclick = function() {
this.style.backgroundColor = "";

var currentCellIndex = this.cellIndex;
var cellClassName = "locked";
var curRow;

if (lockedCellIndex != -1)
{
for (var i=0; i<oTable.rows.length; i++)
{
curRow = oTable.rows[i];
curRow.cells[0].className = "";
if (lockedCellIndex != 0)
{
if (lockedCellIndex == (curRow.cells.length-1))
{
curRow.appendChild(curRow.cells[0]);
}
else
{
curRow.insertBefore(curRow.cells[0], curRow.cells[lockedCellIndex+1]);
}
}
}

if (lockedCellIndex == this.originalCellIndex)
{
lockedCellIndex = -1;
return;
}
}

for (var i=0; i<oTable.rows.length; i++)
{
curRow = oTable.rows[i];

curRow.cells[this.originalCellIndex].className = cellClassName;

if (this.originalCellIndex != 0)
{
curRow.insertBefore(curRow.cells[this.originalCellIndex], curRow.cells[0]);
}
}

lockedCellIndex = this.originalCellIndex;
}
}
*/
//-->
</script>
<div><input type="button" name="search" class="bt1" value="重新查询" onclick="window.location='monthreport.aspx'"></div>
</body>
</html>
