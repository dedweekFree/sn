<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<link rel="stylesheet" type="text/css" href="../../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../../js/spellCode.css">
<script  src="../../inc/js/treePicker.js" language="javascript"></script>
<script src="../../inc/js/pubjs.js"></script>
<script src="../../inc/js/preAfter.js"></script>
<link rel='StyleSheet' href='../../js/dtree.css' type='text/css' />
<title>=======</title>
<script language="javascript">
function ShowDate(idText){
	 var state="dialogHeight: 300px; dialogWidth: 240px; dialogTop: 200px; dialogLeft: 300px; "+             "edge: Raised;  center: Yes; help: No; resizable: Yes; status: No;";
	 var reValue=window.showModalDialog('../../../js/date.html?OpenForm',"myDate",state);
	 if(reValue==null) 
	   ;
	 else
	   idText.value=reValue;
	 }
function init(){
	var a = document.all.roles.value
	if(a=="R8885"){
		document.getElementById("t1").style.display="none";
		document.getElementById("td").style.display="none";
		document.getElementById("td1").style.display="none";
	 }
	stree.location='class_tree.aspx';
}
	  function setVals(dm,mc,code) {
	      setVal(dm,mc);
	      document.thisform.ptype.value=code;
	      document.thisform.ptypename.value=mc;
	 }
</script>
</head>

<body onload="init()">
<form name="thisform" action="PurchaseAuditDetail.aspx" method="post">
<table class="datatable">
  <tr class="trcolor">
    <td colspan="4" align="left">对账查询</td>
  </tr>
  <tr class="trcolor">
    <td>对账日期:</td>
    <td align="left"><input type="text" name="TextZhiDanRiQi1y1" onclick="ShowDate(TextZhiDanRiQi1y1)" style="width:80px" value="$!form_TextZhiDanRiQi1y1"/>-<input type="text" name="TextZhiDanRiQi1y2" onclick="ShowDate(TextZhiDanRiQi1y2)" style="width:80px" value="$!form_TextZhiDanRiQi1y2"/></td>
    <td>产品系列:</td>
    <td align="left"><input type="text" name="ptypename" value="" readonly>
    <input type="hidden" name="ptype" value="">
    <input type='button' name=bt class='btn' value='选择' onclick="click_on_tree_selector($F('ptypename'),$F('dm_zzjg_tree_layer'))">
    <div class="dtree" id="dm_zzjg_tree_layer" style="position:absolute;width:300px;height:208px;visibility:Hidden;z-index:1"> 
    <table width="100%" border="1" cellspacing="0" cellpadding="0" height="100%"><tr><td>
	<IFRAME style="width:100%;height:100%" id='stree' name="swjgdm_tree_frame" marginWidth=0 marginHeight=0 src="" frameBorder=0 
		width="100%" height="100%" scrolling=auto BORDERCOLOR="#000000" ></IFRAME>
    </td></tr></table>
</div>
<script>
   selector_layers[selector_layers.length]=document.all.dm_zzjg_tree_layer;
</script>
    </td>
  </tr>
  <input type="hidden" name="roles" value="$!session_ROLES">
  <tr class="trcolor" id="t1">
    <td>厂区:</td>
    <td align="left"><select name="SelectBuMen" disabled>
    <option value="">请选择厂区</option>
    #set($i=0)
    #foreach($!m in $selFactory)
    <option value="$!m.PK_DEPTDOC">$!m.DEPTNAME</option>
    #set($i=$i+1)
    #end
      </select></td>
          <td id="td">供应商:</td>
    <td id="td1" align="left"><input type="text" name="textfield3" readonly/></td>
  </tr>
  <tr class="trcolor">
    <td colspan="4"><input type="Submit" class="bt1" name="Submit" value="查&nbsp;&nbsp;询" /></td>
  </tr>
</table>
</form>
<table class="datatable" id="table1" border="1">
  <tr class="trcolor">
    <td>供应商名字</td>
    <td>供应商编码</td>
    <td>产品编码</td>
    <td>产品名字</td>
    <td>订单号</td>
    <td>订单数量</td>
    <td>订单日期</td>
    <td>到货数量</td>
    <td>入库数量</td>
    <td>操作</td>
  </tr>
  #set($i=0)
  #foreach($!m in $selPurchaseAudit)
  <tr class="trcolor">
    <td>$!m.CUSTNAME</td>
    <td>$!m.CUSTCODE</td>
    <td>$!m.INVCODE</td>
    <td>$!m.INVNAME</td>
    <td>$!m.VORDERCODE</td>
    <td>$!m.NORDERNUM</td>
    <td>$!m.DORDERDATE</td>
    <td>$!m.NARRVNUM</td>
    <td>$!m.NSHOULDINNUM</td>
    <td><a href="OEMAuditDetail.aspx?vordercode=$!m.VORDERCODE&custcode=$!m.CUSTCODE">明细</a></td>
  </tr>
  #set($i=$i+1)
  #end
  <tr>
	<td colspan='10'><input type="button" class="bt1" name="excel" value="导出EXCEL表"onclick="javascript:method1('table1');"/></td>
  </tr>
</table>
</body>
</html>
<script>
function method1(tableid) {//整个表格拷贝到EXCEL中 
    var curTbl = document.getElementById(tableid); 
    var oXL = new ActiveXObject("Excel.Application"); 
    //创建AX对象excel 
    var oWB = oXL.Workbooks.Add(); 
    //获取workbook对象 
        var oSheet = oWB.ActiveSheet; 
    //激活当前sheet 
    var sel = document.body.createTextRange(); 
    sel.moveToElementText(curTbl); 
    //把表格中的内容移到TextRange中 
    sel.select(); 
    //全选TextRange中内容 
    sel.execCommand("Copy"); 
    //复制TextRange中内容  
    oSheet.Paste(); 
    //粘贴到活动的EXCEL中       
    oXL.Visible = true; 
    //设置excel可见属性 
} 
</script>