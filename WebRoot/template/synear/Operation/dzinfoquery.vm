<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<link rel="stylesheet" type="text/css" href="../../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../../js/spellCode.css">
<title>对账结果汇总表</title>
<script language="javascript">
   function tosave(url){
      document.form1.action=url;
      document.form1.target="saveframe";
      document.form1.submit();
   }
   function ShowDate(idText){
	 var state="dialogHeight: 300px; dialogWidth: 240px; dialogTop: 200px; dialogLeft: 300px; "+             "edge: Raised;  center: Yes; help: No; resizable: Yes; status: No;";
	 var reValue=window.showModalDialog('../../../js/date.html?OpenForm',"myDate",state);
	 if(reValue==null) 
	   ;
	 else
	   idText.value=reValue.substring(0,7);
    }
</script>
</head>
<body>
<form name="thisform" method="post" action='dzinfoquery.aspx'>
   <table class="datatable">
	<tr class="trcolor">
		<td>供应商编码:</td>
		<td align="left"><input type="text" name="custcode" value="#if($form_custcode != "")$form_custcode#end"></td>
		<td>供应商名称:</td>
		<td align="left"><input type="text" name="custname" value="#if($form_custname != "")$form_custname#end"></td>
	</tr>
	<tr class="trcolor">
            <td>对账时间</td>
	    <td align="left"><input type="text" name="accountime" onclick="ShowDate(accountime)" value="$!form_accountime" /></td>
	    <td>&nbsp;</td>
	    <td>&nbsp;</td>
	</tr>
	<tr class="trcolor">
		<td colspan="4"><input class="bt1" type="submit" name="button" value="查&nbsp;&nbsp;询">&nbsp;<input type="button" class="bt1" name="btn" value="导出excel表"onclick="javascript:method1('tb');"></td>
	</td>
   </table>
</form>
<table class="datatable" cellspacing=0 cellpadding=0 border=0 id = "tb">
   #foreach($m in $selenteraccountdate)
   <tr class="trcolor">
	<td>序号</td>
	<td>供应商名称</td>
	<td>供应商编码</td>
	<td>$m.MONTHNAME.trim()对账结果</td>
	<td>$m.MONTHNAME.trim()发票情况</td>
	<td>$m.MONTHNAME.trim()合同情况</td>
	<td>$m.MONTHNAME.trim()应付额</td>
   </tr>
   #end
   #set($i = 1)
       #foreach($m in $selzdydzresultquery)
	   <tr class="trcolor">
	        <td>$i</td>
		<td>$m.CUSTNAME</td>
		<td>$m.USERNAME</td>
		<td>
		   #if($m.RESULTTYPE=="1")
		     相符
		   #elseif($m.RESULTTYPE=="0")
		     不相符
		   #else未审核#end</td>
		<td>
		  #if($m.XX=="1")
		    相符
		  #elseif($m.XX=="0")
		    不相符
		  #end
		</td>
		<td>
		  #if($m.HTRESTLT=="0")
		    无
		  #else
		    有
		  #end
		</td>
		<td>$m.YFE</td>
	   </tr>
	   #set($i =$i+ 1)
    #end
</table>
<form name="form1" method="post"></form>
<iframe name="saveframe" src="about:blank" width="100%" height="0" noresize frameborder=0 framespacing=0 marginheight=0 marginwidth=0></iframe> 
</body>
</html>
<script>
function method1(tableid) {//整个表格拷贝到EXCEL中 
    var curTbl = document.getElementById(tableid); 
    var oXL = new ActiveXObject("Excel.Application"); 
    //创建AX对象excel 
    var oWB = oXL.Workbooks.Add(); 
    //获取workbook对象 
        var oSheet = oWB.ActiveSheet; 
    //激活当前sheet 
    var sel = document.body.createTextRange(); 
    sel.moveToElementText(curTbl); 
    //把表格中的内容移到TextRange中 
    sel.select(); 
    //全选TextRange中内容 
    sel.execCommand("Copy"); 
    //复制TextRange中内容  
    oSheet.Paste(); 
    //粘贴到活动的EXCEL中       
    oXL.Visible = true; 
    //设置excel可见属性 
} 
</script>