<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<link rel="stylesheet" type="text/css" href="../../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../../js/spellCode.css">
<script src="../../../inc/js/calendarold.js"></script>
<script type="text/javascript" src="../../../inc/js/calendar.js"></script>
<script type="text/javascript" src="../../../inc/js/calendar-setup.js"></script>
<script type="text/javascript" src="../../../inc/js/calendar-en.js"></script>
<title>=======</title>
</head>

<body onload="toPage(1);init();">
<form name="form2" method="post">
<table class="datatable" width="100%">
#foreach($!m in $querytendtime)
      <input type="hidden" name="ktine" id="ktine" value="$!m.KTINE">
#end
#foreach($!m in $seltenuser)
  <tr class="trcolor">
    <td colspan="3" align="left">项目名称:$!m.PRONAME&nbsp; 第($!m.ZNUM)轮
    <input type="hidden" name="proname" id="proname" value="$!m.PRONAME">
    <input type="hidden" name="proid" id="proid" value="$!m.PROID">
    <input type="hidden" name="znum" id="znum" value="$!m.ZNUM">
    <input type="hidden" name="prodesc" id="prodesc" value="$!m.PRODESC">
    <input type="hidden" name="prother" id="prother" value="$!m.PROTHER">
    <input type="hidden" name="tendtypeid" id="tendtypeid" value="$!m.TENDTYPEID">
    <input type="hidden" name="typeunitid" id="typeunitid" value="$!m.TYPEUNITID">
    <input type="hidden" name="tendstatus" id="tendstatus" value="$!m.STATUS">
    <input type="hidden" name="pic" id="pic" value="$!m.PIC">
    <input type="hidden" name="ppic" id="ppic" value="$!m.PPIC">
    <input type="hidden" name="isacc" id="isacc" value="$!m.ISACC">
    <input type="hidden" name="znum1" id="znum1" value="$!m.ZNUM">
    <input type="hidden" name="tendquantity" id="tendquantity" value="$!m.TENDQUANTITY">
    <input type="hidden" name="prostatus" id="prostatus" value="$!m.PROSTATUS">
      </td>
  </tr>
  <tr class="trcolor">
    <td>项目模式:</td>
    <td>
	#if($!m.PROSTATUS == 'A')
	    正常
	#end
	#if($!m.PROSTATUS == 'Z')
	    停止
        #end
	#if($!m.PROSTATUS == 'S')
	    暂停
        #end
	#if($!m.PROSTATUS == 'K')
	    开标
        #end
	
    </td>
    <td>项目状态:#if($!m.STATUS == 'A')
	    普通模式
	#end
	#if($!m.STATUS == 'B')
	    竞价模式
        #end
    
    </td>
  </tr>
  <tr class="trcolor">
    <td>开始时间:<input type="text" name="atime" id="atime" value='$!m.ATIME' readonly></td>
    <td>开标时间:<input type="text" name="ktime" id="ktime" value='$!m.KTINE' readonly></td>
    <td>结束时间:<input type="text" name="ztime" id="ztime" value='$!m.ZTIME' readonly></td>
  </tr>
    <tr class="trcolor">
    <td>说明</td>
    <td colspan="2">$!m.PRODESC</td>
  </tr>
  <tr class="trcolor">
    <td>附件</td>
    <td colspan="2">
    #if($m.PROTHER != "")
      <a href="/DownFileServlet?filepath=$!m.PROTHER"">$m.PROTHER.substring($!m.PROTHER.lastIndexOf("/")).replace("/","") 
    </a>
    #end
    </td>
  </tr>
  <tr class="trcolor">
	<td  align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;限#if($!m.PIC=='h')高#else低#end价:&nbsp;<input type="hidden" name="zhidaoprice1" id="zhidaoprice1" value="#if($!m.PIC=='h')#foreach($!mm in $selectminprice)$!mm.TENDPRICE#end#else#foreach($!mm in $selectmaxprice)$!mm.TENDPRICE#end#end"><input type="text" name="zhidaoprice" id="zhidaoprice" value="#if($!m.PIC=='h')#foreach($!mm in $selectminprice)$!mm.TENDPRICE#end#else#foreach($!mm in $selectmaxprice)$!mm.TENDPRICE#end#end">元/$!m.TYPENAME</td>
	<td colspan="2" align="left">
       &nbsp;&nbsp;&nbsp;&nbsp;下一轮开标时间:
       <select name="day1">
	<option value="0">0</option>
	<option value="1">1</option>
	<option value="2">2</option>
	<option value="3">3</option>
	<option value="4">4</option>
	<option value="5">5</option>
	<option value="6">6</option>
	<option value="7">7</option>
	</select>天
	<select name="hour1">
	<option value="0">0</option>
	<option value="1">1</option>
	<option value="2">2</option>
	<option value="3">3</option>
	<option value="4">4</option>
	<option value="5">5</option>
	<option value="6">6</option>
	<option value="7">7</option>
	<option value="8">8</option>
	<option value="9">9</option>
	<option value="10">10</option>
	<option value="11">11</option>
	<option value="12">12</option>
	<option value="13">13</option>
	<option value="14">14</option>
	<option value="15">15</option>
	<option value="16">16</option>
	<option value="17">17</option>
	<option value="18">18</option>
	<option value="19">19</option>
	<option value="20">20</option>
	<option value="21">21</option>
	<option value="22">22</option>
	<option value="23">23</option>
	</select>小时<select name="minute1">
	<option value="0">0</option>
	<option value="5">5</option>
	<option value="10">10</option>
	<option value="15">15</option>
	<option value="20">20</option>
	<option value="25">25</option>
	<option value="30">30</option>
	<option value="35">35</option>
	<option value="40">40</option>
	<option value="45">45</option>
	<option value="50">50</option>
	<option value="55">55</option>
	</select>分
    </td>
  </tr>
  #if($!m.AREANAME != "")
     <tr>
	<td colspan="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;到货目的地：<font color="red">$!m.AREANAME</font></td>
     </tr>
  #end
  <tr class="trcolor"><td colspan="3" align="left"><font color="red">中标或进入下一轮:#if($!m.PIC=='l')请选择高价#else请选择低价#end</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" name="b1" value="中&nbsp;&nbsp;标" class="bt1" onclick="save('K')"/>&nbsp;&nbsp;#if($!m.PROSTATUS!='T')<input type="button" value="进入谈判合同" class="bt1" onclick="save('T')"/>#end
      #if($!m.PROSTATUS=='A')<input type="button" name="b2" class="bt1" value="进入下一轮" onclick="save('F')"/>#end
      <input type="button" name="b3" class="bt1" value="返&nbsp;&nbsp;回" onclick="javascript:location.href='tenderinfo.aspx'"/></td></tr>
  #end
</table>
</form>
<form name="form1" method="post" action=""  target="saveframe">
<table class="datatable" id='tab'>
  <tr class="trcolor">
    <td nowrap><input type=checkbox name=checkbox value='checkbox' onclick="seldata(this)">状态</td>
    <td>招标项目ID</td>
    <td>投标人</td>
    <td>投标价</td>
    <td>投标量</td>
    <td>招标量</td>
    <td>本轮是否投标</td>
    <td>招标地</td>
    <td>投标说明</td>
    <td>投标人附件</td>
  </tr>

<div align="right">
<span id="pg"></span>
</div>
<span id="subdata"></span>
</table></form>
<iframe name="saveframe" src="about:blank" width="100%" height="0" noresize frameborder=0 framespacing=0 marginheight=0 marginwidth=0></iframe> 
</body>
</html>
<script language="javascript">
	var tmpdata = new Array();
	var bData1 = new Array();
		tmpdata = [['ID','投标商','价格','说明','附件','序号','选中','次数','用户名','投标时间','供货能力','单位','投标量','招标量','aaa','是否投标','状态','项目ID','招标价','招标地区','招标地区ID','投标价1','投标量2','PID','PIDS']
		#foreach($!m in $seltendedail)
		#set($i=0)
		,['$!m.PID','$!m.COMPANY','$!m.TENDPRICE','#if($!m.TENDBAK!="")$!m.TENDBAK#else&nbsp; #end','#if($!m.TENDOTER!="")$m.TENDOTER#else&nbsp;#end','$i','N','$!m.TENDNUM','$!m.USERID','$!m.TENDTIME','$!m.SUPPLY','$!m.TYPENAME','$!m.QUANTITY','$!m.TENDQUANTITY','$!m.TENDPRICE','$!m.ISCAST','$!m.TENDSTATUS','$!m.PROID','$!m.PPIC','$!m.AREANAME','$!m.AREAID','$!m.TBPRICE','$!m.TBQUANTITY','$!m.PID','$!m.PIDS']
		  #set($i=$i+1)
		  #end
		]
	var bData1Asc = new Array();
		bData1Asc = [['ID','投标商','价格','说明','附件','序号','选中','次数','用户名','投标时间','供货能力','单位','投标量','招标量','aaa','是否投标','状态','项目ID','招标价','招标地区','招标地区ID','投标价1','投标量2','PID','PIDS']
		#foreach($!m in $seltendedail1)
		#set($i=0)
		,['$!m.PID','$!m.COMPANY','$!m.TENDPRICE','#if($!m.TENDBAK!="")$!m.TENDBAK#else&nbsp; #end','#if($!m.TENDOTER!="")$m.TENDOTER#else&nbsp;#end','$i','N','$!m.TENDNUM','$!m.USERID','$!m.TENDTIME','$!m.SUPPLY','$!m.TYPENAME','$!m.QUANTITY','$!m.TENDQUANTITY','$!m.TENDPRICE','$!m.ISCAST','$!m.TENDSTATUS','$!m.PROID','$!m.PPIC','$!m.AREANAME','$!m.AREAID','$!m.TBPRICE','$!m.TBQUANTITY','$!m.PID','$!m.PIDS']
		  #set($i=$i+1)
		  #end
		]
var pageSize=10;
var pageno=0;
var rdata=new Array();
var areapricedate = new Array();
if(document.form2.pic.value=='l'){
   rdata=tmpdata;
   bData1=tmpdata;
}else{
   rdata=bData1Asc;
   bData1=bData1Asc;
}
function toPage2() 
{
  var element=document.all.pgs;
  if(element.value.search("^-?\\d+(\\.\\d+)?$")!=0){
     alert("页数必须为大于1且小于"+Math.ceil((rdata.length-1)/pageSize)+"的整数!");
     element.focus();
     return false;
  }
  if(element.value<1){
     alert("页数必须为大于1且小于"+Math.ceil((rdata.length-1)/pageSize)+"的整数!");
     element.focus();
     return false;
  }
  if(element.value>Math.ceil((rdata.length-1)/pageSize)){
     alert("页数必须为大于1且小于"+Math.ceil((rdata.length-1)/pageSize)+"的整数!");
     element.focus();
     return false;
  }
  toPage(element.value) 
}
function toPage(page) 
{
try{
  savepage(pageno);
  pageno=page;
  for(var i=tab.rows.length;i>1;i--) tab.deleteRow(i-1);
  for(var i=1;i<=pageSize;i++)
    if(((page-1)*pageSize+i)<rdata.length){{
  	  var row=tab.insertRow();
	  if(rdata[(page-1)*pageSize+i][6]=='Y') 
	      row.insertCell().innerHTML="<input type=checkbox name=checkbox value='checkbox' checked>";
	  else 
	      row.insertCell().innerHTML="<input type=checkbox name=checkbox value='checkbox'>";
          row.insertCell().innerHTML=rdata[(page-1)*pageSize+i][23];
	  if(rdata[(page-1)*pageSize+i][10] == 'A'){
	      row.insertCell().innerHTML="<font color='red'>******</font>";
	  }else{
	      row.insertCell().innerHTML="******";
	  }
	  row.insertCell().innerHTML=rdata[(page-1)*pageSize+i][21];
	  row.insertCell().innerHTML=rdata[(page-1)*pageSize+i][22];
	  row.insertCell().innerHTML=rdata[(page-1)*pageSize+i][13]+rdata[(page-1)*pageSize+i][11];
	  if(rdata[(page-1)*pageSize+i][15]=='N'){
	     row.insertCell().innerHTML='否';
	  }else{
	    row.insertCell().innerHTML='是';
	  }
	  row.insertCell().innerHTML=rdata[(page-1)*pageSize+i][19];
	  row.insertCell().innerHTML=rdata[(page-1)*pageSize+i][3].replace("&amp;nbsp;","")+"&nbsp;";
	  row.insertCell().innerHTML=rdata[(page-1)*pageSize+i][4].replace("&amp;nbsp;","")+"&nbsp;";
    }
 }
 var apg=Math.ceil((rdata.length-1)/pageSize);
 var npg=parseInt(page)+1;
 var ppg=parseInt(page)-1;
 var pagetext="共<font color=red>"+apg+"</font>页<font color=red>"+(rdata.length-1)+"</font>条记录，每页显示<font color=red>"+pageSize+"</font>条，目前是第<font color=red>"+page+"</font>页&nbsp;&nbsp;&nbsp;&nbsp;";
 if(page<apg) pagetext+="<a style='cursor:hand' onclick='toPage2()'><font color=blue>转到</font></a><input type=text id=pgs size=3 value="+npg+">&nbsp;&nbsp;&nbsp;&nbsp;";
 else  pagetext+="<a style='cursor:hand' onclick='toPage2()'><font color=blue>转到</font></a><input type=text id=pgs size=3 value=1>&nbsp;&nbsp;&nbsp;&nbsp;";
 if(page>1) pagetext+="<a style='cursor:hand' onclick='toPage(1)'><font color=blue>首页</font></a>&nbsp;&nbsp;<a style='cursor:hand' onclick='toPage("+ppg+")'><font color=blue>上一页</font></a>&nbsp;&nbsp;"
 if(page<apg) pagetext+="<a style='cursor:hand' onclick='toPage("+npg+")'><font color=blue>下一页</font></a>&nbsp;&nbsp;<a style='cursor:hand' onclick='toPage("+apg+")'><font color=blue>尾页</font></a>"
 
 document.all.pg.innerHTML=pagetext;
 }catch(e){
   alert(e.description)
 }
}

function save(bst){
	try{ 
		savepage(pageno);
		var datahtml="";
		var count = 0;
		for(var i=1;i<bData1.length;i++){
		    if(bData1[i][6]=='Y'){
		        count++;
			datahtml+="<input type=hidden name=pid value='"+bData1[i][0]+"'>";
			datahtml+="<input type=hidden name=company value='"+bData1[i][1]+"'>";
		        datahtml+="<input type=hidden name=tendprice value='"+bData1[i][14]+"'>";
		        datahtml+="<input type=hidden name=tendbak value='"+bData1[i][3]+"'>";
		        datahtml+="<input type=hidden name=tendoter value='"+bData1[i][4]+"'>";
		        datahtml+="<input type=hidden name=tendnum2 value='"+parseInt(bData1[i][7])+"'>";
		        datahtml+="<input type=hidden name=tenduserid value='"+bData1[i][8]+"'>";
		        datahtml+="<input type=hidden name=tendtime value='"+bData1[i][9]+"'>";
			datahtml+="<input type=hidden name=quantity value='"+bData1[i][12]+"'>";

		        datahtml+="<input type='hidden' name='status' value='"+bst+"'>";

			datahtml+="<input type='hidden' name='proid' value='"+document.getElementById('proid').value+"'>";
		       datahtml+="<input type='hidden' name='atime' value='"+document.getElementById('atime').value+"'>";
		       datahtml+="<input type='hidden' name='ktime' value='"+document.getElementById('ktime').value+"'>";
		       datahtml+="<input type='hidden' name='ktine' value='"+document.getElementById('ktine').value+"'>";
		       datahtml+="<input type='hidden' name='ztime' value='"+document.getElementById('ztime').value+"'>";
		       datahtml+="<input type='hidden' name='proname' value='"+document.getElementById('proname').value+"'>";
		       datahtml+="<input type='hidden' name='prodesc' value='"+document.getElementById('prodesc').value+"'>";
		       datahtml+="<input type='hidden' name='prother' value='"+document.getElementById('prother').value+"'>";
		       datahtml+="<input type='hidden' name='tendtypeid' value='"+document.getElementById('tendtypeid').value+"'>";
		       datahtml+="<input type='hidden' name='znum' value='"+(parseInt(document.getElementById('znum').value)+1)+"'>";
		       datahtml+="<input type='hidden' name='znum1' value='"+document.getElementById('znum').value+"'>";
		       datahtml+="<input type='hidden' name='typeunitid' value='"+document.getElementById('typeunitid').value+"'>";
		       datahtml+="<input type='hidden' name='tendstatus' value='"+document.getElementById('tendstatus').value+"'>";
		       datahtml+="<input type='hidden' name='pic' value='"+document.getElementById('pic').value+"'>";
		       datahtml+="<input type='hidden' name='ppic1' value='"+document.getElementById('ppic').value+"'>";
		       datahtml+="<input type='hidden' name='isacc' value='"+document.getElementById('isacc').value+"'>";
		       datahtml+="<input type='hidden' name='zhidaoprice' value='"+document.getElementById('zhidaoprice').value+"'>";
		       datahtml+="<input type='hidden' name='tendquantity' value='"+document.getElementById('tendquantity').value+"'>";
		    }
	      }
	}catch(e){}
	if(count > 0){
		 subdata.innerHTML=datahtml;alert(datahtml);return false;
		 if(bst == 'F'){
			 if(document.form2.zhidaoprice.value==""){
			  alert("指导价格不能为空！");
			  document.form2.zhidaoprice.focus();
			  return false;
			 }else{
			     if(document.form2.pic.value=='h'){
				if(parseInt(document.form2.zhidaoprice1.value) < parseInt(document.form2.zhidaoprice.value)){
				    alert("价格不能高于"+document.form2.zhidaoprice1.value);
				    document.form2.zhidaoprice.select();
				    return false;
				}
			     }else{
				if(parseInt(document.form2.zhidaoprice1.value) > parseInt(document.form2.zhidaoprice.value)){
				    alert("价格不能低于"+document.form2.zhidaoprice1.value);
				    document.form2.zhidaoprice.select();
				    return false;
				}
			     }
			 }
		 }
		 if(bst == 'F'){
		    if(count ==1){
		      document.form1.ppic1.value=document.form2.zhidaoprice.value;
		      document.form1.tendquantity.value=document.form2.tendquantity.value;
		      if(document.form2.ktime.value==document.form2.ztime.value){
		            alert("开标时间等于结束时间，不能进入下一轮！！！");
			    return false;
		      }else{
		      var time =  new Date(new Date(document.form1.ktime.value.replace("-","/").replace("-","/")).getTime()+document.form2.day1.value*24*60*60*1000+document.form2.hour1.value*60*60*1000+document.form2.minute1.value*60*1000).print("%Y-%m-%d %H:%M");
		      document.form1.ktime.value = time;
		      if(time == document.form2.ktime.value){
		          alert("请选择下一轮开标时间");
			  return false;
		      }else{
			  if((new Date(time.replace(/-/g,"/"))-new Date(document.form2.ztime.value.replace(/-/g,"/")))/(24*60*60*1000) > 0){
                              document.form1.ktime.value = document.form2.ztime.value;
			  }
		      }
		      if((new Date(time.replace(/-/g,"/"))-new Date(document.form2.ztime.value.replace(/-/g,"/")))/(24*60*60*1000) > 0){
		            document.form1.ktime.value = document.form2.ztime.value;
		      }
                      }
		   }else{
		      var time ;  
		      for(var j=0; j < count; j ++){
			document.form1.ppic1[j].value = document.form1.zhidaoprice[0].value;
			document.form1.tendquantity[j].value=document.form1.tendquantity[0].value;
			if(document.form1.ktime[j].value==document.form2.ztime.value){
			     alert("开标时间等于结束时间，不能进入下一轮！！！");
			     return false;
			}else{
				time = new Date(new   Date(document.form1.ktime[j].value.replace("-","/").replace("-","/")).getTime()+document.form2.day1.value*24*60*60*1000+document.form2.hour1.value*60*60*1000+document.form2.minute1.value*60*1000).print("%Y-%m-%d %H:%M");
				document.form1.ktime[j].value = time;
				if(time == document.form2.ktime.value){
					  alert("请选择下一轮开标时间");
					  return false;
				      }else{
					  if((new Date(time.replace(/-/g,"/"))-new Date(document.form2.ztime.value.replace(/-/g,"/")))/(24*60*60*1000) > 0){
					      document.form1.ktime[j].value = document.form1.ztime[j].value;
					  }
				      }
			}
		      }
		    }
		 }
		 if(bst=='F'){
		 document.all.form1.action="upstatusubareaprice.aspx";
		 }else{
		 document.all.form1.action="upstatusubareaprice3.aspx";
		 }
		 document.all.form1.target="saveframe";
		 document.all.form1.submit();
        }else{
	     alert("至少选择一条记录");
	     return false;
	}
 }

function savepage(page)
{
  if(page>0){
    for(var i=1;i<tab.rows.length;i++){
      if(document.all.checkbox[i].checked){
	      rdata[(page-1)*pageSize+i][6]='Y';
	      rdata[(page-1)*pageSize+i][7] = parseInt(bData1[i][7])+1;
      } else {rdata[(page-1)*pageSize+i][6]='N';}
      for(var j=1;j<3;j++){
        if(tab.rows[i].cells[j+1].innerText==""){
	  rdata[(page-1)*pageSize+i][j]=document.all.editbox.value;
	}
	else{
          rdata[(page-1)*pageSize+i][j]=tab.rows[i].cells[j].innerText;
        }
      }
      bData1[rdata[(page-1)*pageSize+i][5]]=rdata[(page-1)*pageSize+i];
    }
  }
}

function seldata(obj)
{
  for(var i=1;i<tab.rows.length;i++){
      document.all.checkbox[i].checked=obj.checked
  }
}

function imp(){
	var ReturnAllQualityValue=showModalDialog('nextpage.aspx',"a",'dialogWidth:250px;dialogHeight:200px;dialogLeft:370px;dialogTop:320px;center:yes; help:yes;resizable:yes;status:yes');
	  
  }

var undefined;

function init(){
  uniteCols(document.all.tab);//执行
}

function uniteTable(thistab,colLength){   
  var   rn=thistab.rows.length;//取得行数   
  var   rowspann=0;   
  for(j=colLength-1;j>=0;j--){//从第0列开始，合并多少列   
    for(i=rn-1;i>0;i--){//从倒数第一行开始往上检查   
      if(thistab.rows[i].cells[j].innerText==thistab.rows[i-1].cells[j].innerText&&thistab.rows[i].cells[j].colSpan==thistab.rows[i-1].cells[j].colSpan){//与上面一行比较，如果两行相等就合计当前行的合并行数，并删除当前行。   
        rowspann+=thistab.rows[i].cells[j].rowSpan;   
        thistab.rows[i].deleteCell(j);   
      }else{   
        thistab.rows[i].cells[j].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。   
        rowspann=0;   
      }   
    }   
    //检测无表头的表   
    if(i==0&&rowspann>0){   
      thistab.rows[i].cells[j].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。   
      rowspann=0;   
    }   
    
  }   
}  
//本业务合并
function uniteCols(thistab){   
  var   rn=thistab.rows.length;//取得行数   
  var   rowspann=0;   
  for(i=rn-1;i>0;i--){//从倒数第一行开始往上检查  
      if(thistab.rows[i].cells[0].innerText==thistab.rows[i-1].cells[0].innerText&&thistab.rows[i].cells[0].colSpan==thistab.rows[i-1].cells[0].colSpan){//与上面一行比较，如果两行相等就合计当前行的合并行数，并删除当前行。   
        rowspann+=thistab.rows[i].cells[0].rowSpan; 
	thistab.rows[i].deleteCell(2);
	thistab.rows[i].deleteCell(1);
 
	//thistab.rows[i].deleteCell(0);
      }else{   
        //thistab.rows[i].cells[0].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。
	thistab.rows[i].cells[1].rowSpan+=rowspann;
	thistab.rows[i].cells[2].rowSpan+=rowspann;
	
alert(thistab.rows[i].cells[1].rowSpan);
        rowspann=0;   
      }   
  }   
  //检测无表头的表   
  if(i==0&&rowspann>0){   
        //thistab.rows[i].cells[0].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。
	thistab.rows[i].cells[1].rowSpan+=rowspann;
	thistab.rows[i].cells[2].rowSpan+=rowspann;
      rowspann=0;   
  }   
} 
function setvalue(step,status){
  document.form1.step.value=step;
  document.form1.status.value=status;
  document.form1.submit();
}
</script>