<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<link rel="stylesheet" type="text/css" href="../../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../../js/spellCode.css">
<script Language="JavaScript" src="../../../include/js/PopCalendar.js"></script>
<script  src="../../../inc/js/treePicker.js" language="javascript"></script>
<script  src="../../../inc/js/calendar.js" language="javascript"></script>
<script src="../../../inc/js/pubjs.js"></script>
<title>供应商授权</title>
<script language="javascript">
	function s(){
		var b= new Date();
		document.all.tendtypeid.value=b.getTime();
		form1.submit();
	}
	function toacc(){
	     var aa = document.form1.ObjSelect;
	     if(document.form1.proid.value==""){
		alert("项目名称不能为空");
		return false;
	     }
	     var datahtml="";
	     var i;
	     for(i = 0 ; i < aa.length; i ++){
		datahtml+="<input type=hidden name=users1 value='"+aa[i].value+"'>";
	     }
	     if(i == 0){
		alert("没有选择用户不能授权");
		return false;
	     }
	     subdata.innerHTML=datahtml;
	     document.form1.action="tendacc1.aspx";
	     document.form1.target="dataframe";
	     form1.submit();
	}
	function toquery(){
	     if(document.form1.proid.value==""){
		alert("项目名称不能为空");
		return false;
	     }
		document.form1.action="tenderVendorAcc.aspx";
		document.form1.submit();
	}
	function setVals(dm,mc,code) {
      setVal(dm,mc);
      form1.ptype.value=code;
      form1.ptypename.value=mc;
      form1.tendtypeid.value=dm;
      }
</script>
</head>

<body>
<form   name="form1" method="post">

<table border='1' width="80%"> 
<tr class="trcolor" align="right">
   <td colspan="4" align="center">
       项目名称:
       <select name="proid">
       <option value=""></option> 
        #foreach($!m in $tendtypename)
	<option value="$!m.PROID" #if($!$!form_proid == $!m.PROID) selected #end>$!m.PRONAME</option>
	#end 
	</select>
       <input type="hidden" name="users">
   </td>
</tr>
<tr class="trcolor">
	<td colspan="4" align="center">
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;项目类型:<input type="text" name="ptypename" value="$!form_ptypename" readonly>
	<input type="hidden" name="ptype" value="$!form_ptype">
	<input type="hidden" name="tendtypeid" value="$!form_tendtypeid">
	<input type='button' name=bt class="bt1" value='选择' onclick="click_on_tree_selector($F('ptypename'),$F('dm_zzjg_tree_layer'))">
	<div class="dtree" id="dm_zzjg_tree_layer" style="position:absolute;width:300px;height:208px;visibility:Hidden;z-index:1"> 
	<table width="100%" border="1" cellspacing="0" cellpadding="0" height="100%"><tr><td>
		<IFRAME style="width:100%;height:100%" name="swjgdm_tree_frame" marginWidth=0 marginHeight=0 src="class_tree.aspx" frameBorder=0 
			width="100%" height="100%" scrolling=auto BORDERCOLOR="#000000" ></IFRAME>
	</td></tr></table>
	</div>
	<script>
	   selector_layers[selector_layers.length]=document.all.dm_zzjg_tree_layer;
	</script>	
	</td>
</tr>
<tr class="trcolor">
	<td colspan="4" align="center">
		<input type="button" name="acc" class="bt1" value="查询" onclick="toquery()">&nbsp;&nbsp;<input type="button" name="acc" class="bt1" value="授权" onclick="toacc()">
	</td>
</tr>      
 
<table border='1' width="80%"> 
<tr> 
<td>   
<select   name=SrcSelect   size=6   style= "font-size:11pt;width:200px;height:160px "   multiple   ondblclick= "moveLeftOrRight(document.form1.SrcSelect,document.form1.ObjSelect) ">   
 #foreach($!m in $selvendor1)
   <option value= "$!m.USERNAME">$!m.COMPANY</option>
  #set($i=$i+1)
  #end  
</select> 
</td>   
<td   width= "30px ">         
<input   align= "left"   type=button class="bt1"   value= " > "     onclick= "moveLeftOrRight(document.form1.SrcSelect,document.form1.ObjSelect) "     > <br> <br> 
<input   align= "left "   type=button  class="bt1"  value= " < "     onclick= "moveLeftOrRight(document.form1.ObjSelect,document.form1.SrcSelect) "     > 
</td> 
<td>   
<select   name=ObjSelect id="ObjSelect"   size=6   style= "font-size:11pt;width:200px;height:160px "   multiple   ondblclick= "moveLeftOrRight(document.form1.ObjSelect,document.form1.SrcSelect) ">   
    
</select>
</select> 
</td>   
<td   width= "30px "> 
<input   type=button class="bt1"  value= " A "     onclick= "moveUp() "   >   <br> <br>   
<input   type=button  class="bt1" value= " V "     onclick= "moveDown() "   > 
</td> 
</tr>   
</table> 
<span id="subdata"></span>
</table></form>
<div>
        <iframe name="dataframe" src="" width="0" height="0"></iframe>
    </div>
</body>     
    
<script   language=javascript>     
function   moveUp()     
{   
var   theObjOptions=document.form1.ObjSelect.options; 
for(var   i=1;i <theObjOptions.length;i++) 
{ 
if(   theObjOptions[i].selected   &&   !theObjOptions[i-1].selected   ) 
{ 
swapOptionProperties(theObjOptions[i],theObjOptions[i-1]); 
} 
} 
}     
    
function   moveDown()     
{   
var   theObjOptions=document.form1.ObjSelect.options; 
for(var   i=theObjOptions.length-2;i> -1;i--) 
{ 
if(   theObjOptions[i].selected   &&   !theObjOptions[i+1].selected   ) 
{ 
swapOptionProperties(theObjOptions[i],theObjOptions[i+1]); 
} 
} 
}     

function   swapOptionProperties(option1,option2){ 
var   tempStr=option1.value; 
option1.value=option2.value; 
option1.value=tempStr; 
tempStr=option1.text; 
option1.text=option2.text; 
option2.text=tempStr; 
tempStr=option1.selected; 
option1.selected=option2.selected; 
option2.selected=tempStr; 
}     
    
function   moveLeftOrRight(fromObj,toObj)     
{   
for(var   i=0;i <fromObj.length;i++) 
{ 
var   srcOption=fromObj.options[i]; 
if(srcOption.selected) 
{ 
toObj.appendChild(srcOption);
i--;  
} 
} 
}     
    
    
  
</script>  
</html>
