<html>
<head>
	<title>系统操作结果</title>
	<script type="text/javascript">
 
function testNc(){
   var bst = "";
  var hdatahtml="";
  #foreach($m in $getFzCustomerInfo)
      #if($m.FREEOFCREMNYCHECK=='N')
	  if(parseFloat(document.all.jhqj.innerText)<0){
	     alert("信用余额不够！");
	     if(bst=='3')  return false;
	  }
      #end
      #foreach($x in $getFzCustomerInfo)
	   var bno="PK${m.BNO}${m.PK2}"
	   //hdatahtml+="<input type=hidden name=pk_preorder value='${m.PK}PK${m.BNO}'>";
	   //hdatahtml+="<input type=hidden name=scroll value='$form_scroll'>";
	   hdatahtml+="<input type=hidden name=bdeliver value='N'>";
	   //hdatahtml+="<input type=hidden name=custpk value='$form_custpk'>";
	  // hdatahtml+="<input type=hidden name=custdocpk value='$form_custdocpk'>";
	   hdatahtml+="<input type=hidden name=cbiztype value='$m.PK_DEFBUSITYPE'>";//业务类型
	   hdatahtml+="<input type=hidden name=ccurrencytypeid value='$m.PK_CURRTYPE1'>";//币种 $m.CURRTYPENAME
	   hdatahtml+="<input type=hidden name=ccustomerid value='$m.PK_CUMANDOC'>";//客户档案主键
	   hdatahtml+="<input type=hidden name=cdeptid value='$m.PK_RESPDEPT1'>";//部门主键
	   hdatahtml+="<input type=hidden name=cemployeeid value='$m.PK_RESPPSN1'>";//业务员 $m.PSNNAME
	   hdatahtml+="<input type=hidden name=coperatorid value='0001AG100000000000U2'>";//制单人
	   hdatahtml+="<input type=hidden name=creceiptareaid value='$m.PK_AREACL'>";//收货地区 $m.AREACLNAME
	   hdatahtml+="<input type=hidden name=creceiptcorpid value='$m.PK_CUMANDOC'>";//开票单位
	   hdatahtml+="<input type=hidden name=creceiptcustomerid value='$m.PK_CUMANDOC'>";//收货单位
	   hdatahtml+="<input type=hidden name=csalecorpid value='$m.PK_SALESTRU'>";//销售组织 $m.VSALESTRUNAME
	   hdatahtml+="<input type=hidden name=vreceiveaddress value='$m.ADDRNAME'>";//收货地址
	   hdatahtml+="<input type=hidden name=creceipttype value='38'>";//单据类型
	   hdatahtml+="<input type=hidden name=dabatedate value='$m.ENDDATE'>";//失效日期
	   hdatahtml+="<input type=hidden name=dbilldate value='$m.DBILLDATE'>";//订货日期
	   hdatahtml+="<input type=hidden name=dmakedate value='$m.MAKEDATE'>";//制单日期
	   hdatahtml+="<input type=hidden name=dreceivetime value='00:00:00'>";//到货时间
	   hdatahtml+="<input type=hidden name=dr value='0'>";//
	   hdatahtml+="<input type=hidden name=fstatus value='3'>";//状态:1自由 2审批 3冻结 4关闭 5作废 7提交
	   hdatahtml+="<input type=hidden name=nexchangeotobrate value='1.00000000'>";//折辅汇率
	   hdatahtml+="<input type=hidden name=pk_corp value='$m.PK_CORP'>";//
	   hdatahtml+="<input type=hidden name=vdef10 value='$m.LDATE'>";//
	   hdatahtml+="<input type=hidden name=vdef11 value='$m.DEF2'>";//小客户标记
	   hdatahtml+="<input type=hidden name=vreceiptcode value='"+bno+"'>";//单据号
	   hdatahtml+="<input type=hidden name=linkman value='$m.VDEF5'>";//联系人
	   hdatahtml+="<input type=hidden name=tel value='$m.VDEF6'>";//联系电话
	   hdatahtml+="<input type=hidden name=vnote value='$m.VNOTE'>";

	   hdatahtml+="<input type=hidden name=ccalbodyid value='$m.PK_CALBODY'>";//发货库存组织 $m.BODYNAME

	   hdatahtml+="<input type=hidden name=proc value='insert'>";  //业务操作
      #end
  #end
  var datahtml="";
  var num=0;
  var nextnum=0;
  var rno=0;
  var billno="";
  var packnumber=0;
  var disnumber=0;
  #foreach($m in $getFzSoPreOrderB) 
       rno++;
       billno=bno+(1000+rno);
       datahtml+="<input type=hidden name=pk_preorder_b value='$m.PK_PREORDER_B'>";//主键

       datahtml+="<input type=hidden name=cinvbasdocid value='$m.PK_PREORDER_B'>"; //存货主键
       datahtml+="<input type=hidden name=cinventoryid value='$m.CINVENTORYID'>"; //存货档案主键
       datahtml+="<input type=hidden name=cpackunitid value='$m.CPACKUNITID'>"; //辅单位
       datahtml+="<input type=hidden name=cunitid value='$m.CUNITID'>"; //主单位
       datahtml+="<input type=hidden name=cporjectid value='$m.CPORJECTID'>"; //价格项目ID
       datahtml+="<input type=hidden name=cpriceid value='$m.CPRICEID'>"; //价格政策ID
       datahtml+="<input type=hidden name=cpriceitemtableid value='$m.CPRICEITEMTABLEID'>"; //价目表ID
       datahtml+="<input type=hidden name=nprice value='$m.NPRICE'>";
       datahtml+="<input type=hidden name=nnumber value='$m.NNUMBER'>";
       datahtml+="<input type=hidden name=nmny value='$m.NMNY'>";
      // packnumber=parseInt(bData1[i][5])/parseFloat(bData1[i][16])+'';
       datahtml+="<input type=hidden name=npacknumber value='$m.NPACKNUMBER'>";
       datahtml+="<input type=hidden name=crowno value='$m.CROWNO'>"; //行号
       datahtml+="<input type=hidden name=disnum value='$m.VDEF12'>"; //折算率
      // disnumber=parseFloat(bData1[i][5])*parseFloat(bData1[i][17]);
       datahtml+="<input type=hidden name=disnum2 value='$m.VDEF13'>"; //折算量
      // num+=parseInt(bData1[i][5]);
   #end
 subdata.innerHTML=hdatahtml+datahtml;
}
	function aaaa(){
	testNc();
	form_submit.submit();
	}
	</script>

</head>
<body onload="aaaa()">
<form name="form_submit" method="post" action="newPreorderSubmittest.nc">
<span id="subdata"></span>
</form>
</body>
</html>

