<HTML>
<HEAD>		
<title>费用申请表</title>
<link rel="stylesheet" type="text/css" href="../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../js/spellCode.css">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">


<script  src="../../../inc/js/treePicker.js" language="javascript"></script>
<script Language="JavaScript" src="../../../include/js/PopCalendar.js"></script>
<script src="../../../inc/js/pubjs.js"></script>
<script src="../../../inc/js/preAfter.js"></script>
<style> 
.FixedTitleRow 
{ 
position: relative; 
top: expression(this.offsetParent.scrollTop-2); 
z-index: 10; 
background-color: #E6ECF0; 
} 
.FixedTitleColumn 
{ 
position: relative; 
left: expression(this.parentElement.offsetParent.scrollLeft); 
} 
.FixedDataColumn 
{ 
position: relative; 
left: expression(this.parentElement.offsetParent.parentElement.scrollLeft); 
} 
.mainDiv    
{    
overflow:auto;    
scrollbar-face-color:9999ff; 
height:expression((document.body.clientHeight-this.offsetTop-20>this.children[0].offsetHeight)?(this.children[0].offsetHeight+20)   :   (document.body.clientHeight-this.offsetTop-20));    
width:expression((document.body.clientWidth-this.offsetLeft-20));   
}
</style> 

<SCRIPT LANGUAGE="JavaScript">
var num1 = 0;
var num2 = 0;
var num3 = 0;
var num4 = 0;
var num5 = 0;
var num6 = 0;
var num7 = 0;
function accAdd(arg1,arg2){ 
	var r1,r2,m; 
	try{r1=arg1.toString().split(".")[1].length}catch(e){r1=0} 
	try{r2=arg2.toString().split(".")[1].length}catch(e){r2=0} 
	m=Math.pow(10,Math.max(r1,r2)) 
	return (arg1*m+arg2*m)/m 
 } 
//-->
</SCRIPT>
</HEAD>
<BODY>

<table border="0" cellspacing="0" cellpadding="0" bgcolor="#ffffff" width="98%" align="center" id="tb" 

class="datatable">
<tr height="20"  align="center"   class="FixedTitleRow">
	<td nowrap="nowrap" >排产日期</td>
	<td nowrap="nowrap">品类</td>
	<td nowrap="nowrap" >产品编码</td>
	<td nowrap="nowrap" >产品名称</td>
	<td nowrap="nowrap" >规格</td>
	<td nowrap="nowrap">单件重</td>
	<td nowrap="nowrap">最初排产量</td>
	<td nowrap="nowrap">排产量</td>
        <td nowrap="nowrap">实际产量(件)</td>
	<td nowrap="nowrap">实际产量(吨)</td>
	<td nowrap="nowrap">计划完成率</td>
	<td nowrap="nowrap">是否调整</td>
	<td nowrap="nowrap">原因分析</td>
</tr>
    #set($i=1) 
    #foreach($m in $getPaiChanDetail)
    
  		<tr height="20" class="trcolor">
			
		     <td align="center" nowrap="nowrap">$!m.BILLDATE</td>
			<td align="center" nowrap="nowrap">$!m.INVCLASSNAME</td>
			<td align="center" nowrap="nowrap">$!m.INVCODE</td>
			<td align="center" nowrap="nowrap">$!m.INVNAME</td>
			<td align="center" nowrap="nowrap">$!m.INVSPEC</td>
			<td align="center" nowrap="nowrap">#if($!m.UNITWEIGHT!="")$!m.UNITWEIGHT#else&nbsp;#end</td>
			<td align="center" nowrap="nowrap">$!m.PLANNUMOLD</td>
			<td align="center" nowrap="nowrap">$!m.PLANNUM</td>
			<td align="center" nowrap="nowrap">$!m.NINNUM</td>
			<td align="center" nowrap="nowrap">#if($!m.TON!="")$!m.TON#else&nbsp;#end</td>
			<td align="center" nowrap="nowrap">$!m.ATIO</td>
			<td align="center" nowrap>#if($!m.PLANNUM != $!m.PLANNUMOLD)<font color="red">是</font>#elseif($!m.PLANNUM == $!m.PLANNUMOLD)否#end</td>
			<td align="center" nowrap="nowrap">#if($!m.REALMEMO!="")$!m.REALMEMO#else&nbsp;#end</td>
		 </tr>
		 #set($i=$i+1)
		 <script>
		 num2=accAdd(num2,$m.PLANNUMOLD);
		 num3=accAdd(num3,$m.PLANNUM);
		 num4=accAdd(num4,$m.NINNUM);
		 num5=accAdd(num5,$m.TON);
		 </script>
   #end  
   #if($i==1)
     <tr height="20" bgcolor="#eeeeee" class="trcolor">
     <td colspan="9" bgcolor="#eeeeee" align="center" class="trcolor">没有相关信息</td>
     </tr>
   #else
     <tr height="20" bgcolor="#eeeeee" class="trcolor">
     <td bgcolor="#eeeeee" colspan="5" align="center" class="trcolor">合计</td>
     <td bgcolor="#eeeeee" align="center" class="trcolor">&nbsp;</td>
     <td bgcolor="#eeeeee" align="center" class="trcolor"><script>document.write(num2);</script></td>
     <td bgcolor="#eeeeee" align="center" class="trcolor"><script>document.write(num3);</script></td>
     <td bgcolor="#eeeeee" align="center" class="trcolor"><script>document.write(num4);</script></td>
     <td bgcolor="#eeeeee" align="center" class="trcolor"><script>document.write(num5);</script></td>
     <td bgcolor="#eeeeee" align="center" class="trcolor">&nbsp;</td>
     <td bgcolor="#eeeeee" align="center" class="trcolor">&nbsp;</td>
     <td bgcolor="#eeeeee" align="center" class="trcolor">&nbsp;</td>
     </tr>
   #end
</table>

<div align="center"><input type="button" class="bt1" value=" 返 回 " name="B222" onClick="javascript:window.history.go(-1);">&nbsp;<input type="button" class="bt1" name="btn" value="导出excel表"onclick="javascript:method1('tb');"> </div>

</BODY>
</HTML>
<script>
function method1(tableid) {//整个表格拷贝到EXCEL中 
    var curTbl = document.getElementById(tableid); 
    var oXL = new ActiveXObject("Excel.Application"); 
    //创建AX对象excel 
    var oWB = oXL.Workbooks.Add(); 
    //获取workbook对象 
        var oSheet = oWB.ActiveSheet; 
    //激活当前sheet 
    var sel = document.body.createTextRange(); 
    sel.moveToElementText(curTbl); 
    //把表格中的内容移到TextRange中 
    sel.select(); 
    //全选TextRange中内容 
    sel.execCommand("Copy"); 
    //复制TextRange中内容  
    oSheet.Paste(); 
    //粘贴到活动的EXCEL中       
    oXL.Visible = true; 
    //设置excel可见属性 
} 
</script>