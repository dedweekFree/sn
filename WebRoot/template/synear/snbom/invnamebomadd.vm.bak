<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>======</title>
<script src="../../js/sunnyfunc.js"></script>
<script>
		var now = new Date(); //获取系统日期 
var yyy ="'"+now.getYear()+"'"; //截取年		
var yy = yyy.substring(3,5);
var mon = now.getMonth()+1; //截取月
var dd = now.getDate(); //截取日
//取时间 
var hh = now.getHours(); //截取小时 
var ss = now.getTime() % 60000; //获取时间，因为系统中时间是以毫秒计算的，所以秒要通过余60000得到。 
var mil = now.getMilliseconds();//毫秒
ss= (ss - (ss % 1000)) / 1000; //然后，将得到的毫秒数再处理成秒 
var clock = yy; //将得到的各个部分连接成一个日期时间 
if (parseInt(mon) < 10) mon = '0'+mon; //字符串 
clock += mon;  
if (parseInt(dd) < 10) dd = '0'+dd;  
clock += dd;
if (parseInt(hh) < 10) hh = '0'+hh;  
clock += hh; 
if (parseInt(ss) < 10) ss = '0'+ss;  
clock += ss;
if (parseInt(mil) < 10){mil = '00'+mil;
}else if(10 <= parseInt(mil) < 100){mil = '0'+mil;}
clock += (mil.substr(0,3));
var bomid = 'bom'+clock;
var bid=0;
var submitok=false;
var ChosedList=new Array();
var header=9;		//定单头的个数
var thisCol=15;	//表单体的列数
var others=0;		//表单中非表单体的控件数
var thisRow=10;     //初始行数
var submitok=false; //是否已提交
var testRow=-1;     //验证数据行号
var row=thisRow;
var submitfirst=true;
var undefined;
var seleRow=0;
var datatb;
var lingtuo="";
var shenyukeru="0";
var kuwei="";
var data=new Array();//单个记录元素数据数组
//一维数组赋值     
function data1()
{
	var data=new Array()
	args=data1.arguments;
	for(i=0;i<args.length;i++)
	{
	  data[i]=args[i];
	}
	return data;
}
     
//二维数组赋值     
function data2(data)
{
	this.data=data;
}

var bData1=new Array(); 
   data=new data1('产品名称','产品代码','产品规格','产品主键');
   bData1[0]=new data2(data);
 #set($i=1)
 #foreach($m in $queryncccpinvbasdoc)
   data=new data1('$m.ITEMDESC','$!m.ITEMCODE','$m.ITEMSPEC','$m.NC_PK');
   bData1[$i]=new data2(data);
   #set($i=$i+1)
 #end
/**
*在行上聚焦和失焦
**/
function MouseOver(i){
   for(j=0;j<i.cells.length;j++){
       i.cells[j].style.backgroundColor='#3399FF'; i.cells[j].style.cursor='hand';
   }
}
function MouseOut(i){
   for(j=0;j<i.cells.length;j++){
       i.cells[j].style.backgroundColor='#FFFFFF';
   }
}

function addListener() {
 var inputList = document.body.getElementsByTagName("INPUT");
 if(inputList[0]) firstInput = inputList[0];
    for(var i=0;i<inputList.length;i++) {
      inputList[i].attachEvent ('onfocus', onInputFocus);
   }
}
function onInputFocus(){
     for(i=0;i<dtb.length;i++)
       tb.rows[i*2+2].style.display="none";
}
function addRow() 
{ 
     var tempR=document.all.tb.insertRow();
	 tempR.bgcolor="#FFFFFF";
	 var temp1=tempR.insertCell();	
	 var temp2=tempR.insertCell();	
	 var temp3=tempR.insertCell();	
	 var temp4=tempR.insertCell();
	 var temp13 = tempR.insertCell();
	 var temp5=tempR.insertCell();
	 var temp6=tempR.insertCell();
	 var temp7=tempR.insertCell();
	 var temp8=tempR.insertCell();
	 var temp9=tempR.insertCell();
	 var temp10=tempR.insertCell();
	 var temp11=tempR.insertCell();
	 var temp12=tempR.insertCell();
	 
	
	 temp2.style.display='none';
	 temp10.style.display='none';

	 
	 temp1.innerHTML="<p align=\"center\"><input name='invbasname' id='invbasname"+row+"' value='' style='width:200' class='login3' type='text' readonly><input type='button' value='...' onclick=togetmont('yclquery.aspx?row="+row+"')>";
	 temp2.innerHTML="<p align=\"center\"><input name='F_nc_pk' id='F_nc_pk"+row+"' style='width:150' class='login3' type='hidden' readonly>";
         temp3.innerHTML="<p align=\"center\"><select name='masname' id='masname"+row+"' disabled>#foreach($m in $snmeasdocquery)<option value='$!m.PK_MEASDOC'>$!m.MEASNAME</option>#end</select>";
         temp4.innerHTML="<p align=\"center\"><select name='invtype' id='invtype"+row+"'><option value='A'>一般物料</option><option value='B'>自制复合物料</option><option value='C'>领用复合物料</option></select>";
         temp13.innerHTML="<p align=\"center\"><input name='fhwlbomid' id='fhwlbomid"+row+"' value='' style='width:70' class='login3' type='text' readonly><input type='button' value='...' onclick=togetmont1('fhwlbomquery.aspx?row="+row+"&pk_invbasdoc='+document.getElementById('F_nc_pk"+row+"').value,"+row+")>";
	 temp5.innerHTML="<p align=\"center\"><input name='F_number' id='F_number"+row+"' class='login3' style='width:70' type='text' onkeyup=\"if(isNaN(value))execCommand('undo')\" onafterpaste=\"if(isNaN(value))execCommand('undo')\">";
	 temp6.innerHTML="<p align=\"center\"><input name='ERRU' id='ERRU"+row+"' class='login3' style='width:70' type='text' onkeyup=\"if(isNaN(value))execCommand('undo')\" onafterpaste=\"if(isNaN(value))execCommand('undo')\">";
	 temp7.innerHTML="<p align=\"center\"><input name='ERRD' id='ERRD"+row+"' class='login3' style='width:70' type='text' onkeyup=\"if(isNaN(value))execCommand('undo')\" onafterpaste=\"if(isNaN(value))execCommand('undo')\">";
	 temp8.innerHTML="<p align=\"center\"><input name='DIS' id='DIS"+row+"' class='login3' style='width:70' type='text' onkeyup=\"if(isNaN(value))execCommand('undo')\" onafterpaste=\"if(isNaN(value))execCommand('undo')\">";
	 temp9.innerHTML="<p align=\"center\"><input name='DISNUM' id='DISNUM"+row+"' class='login3' style='width:70' type='text' onkeyup=\"if(isNaN(value))execCommand('undo')\" onafterpaste=\"if(isNaN(value))execCommand('undo')\">";
	 temp10.innerHTML="<p align=\"center\"><input name='PROCID' id='PROCID"+row+"' class='login3' style='width:70' type='text'>";
         temp11.innerHTML="<p align=\"center\"><select name='CLSID' id='CLSID"+row+"'><option value=''></option>#foreach($m in $snbompclsqueryall)<option value='$!m.CLSID'>$!m.CLSNAME</option>#end</select>";
	 temp12.innerHTML="<p align=\"center\"><select name='FLAG' id='FLAG"+row+"'><option value='Y'>计算成本</option><option value='N'>不计成本</option></select>";
	 //alert(row*thisCol+header+1);
	 document.form1.elements[row*thisCol+header+1].focus();
	 row=row+1; 
     tempR=document.all.tb.insertRow();
     temp1=tempR.insertCell(); 
     temp1.innerHTML="<table id=\"dtb\"></table>";
     temp1.colSpan=12; 
}
function init()
{
    addListener();
}

function ShowDate(idText){
 var state="dialogHeight: 300px; dialogWidth: 240px; dialogTop: 200px; dialogLeft: 300px; "+             "edge: Raised;  center: Yes; help: No; resizable: Yes; status: No;";

 var reValue=window.showModalDialog('../../../js/date.html?OpenForm',"myDate",state);
 if(reValue==null) 
   ;
 else
   idText.value=reValue;
 
 }
 function save(status){
    var tab = document.getElementById("tb");
    var datahtml="";
    if(document.form1.invname.value == ""){
       alert("产品不能为空");
       return false;
    }
    if(document.form1.version.value == ""){
       alert("版本号不能为空");
       document.form1.version.focus();
       return false;
    }
    if(document.form1.meaname.value == ""){
       alert("计量单位不能为空");
       document.form1.meaname.focus();
       return false;
    }
    if(document.form1.bomcls.value == ""){
       alert("物料类型不能为空");
       document.form1.bomcls.focus();
       return false;
    }
 	for(var i=0;i<tab.rows.length;i++){
		try{
		var a = document.getElementById("F_number"+i).value;
		}catch(e){
		var a="";
		}
		if(a!="" && document.getElementById("F_nc_pk"+i).value!=""  &&　document.getElementById('masname'+i).value!=""){
		   if(document.getElementById('invtype'+i).value == 'B' || document.getElementById('invtype'+i).value == 'C'){
		       if(document.getElementById('fhwlbomid'+i).value == ''){
		           alert("关联BOM不能为空");
			   return false;
		       }
		   }
		   datahtml+="<input type=hidden name=invtype value='"+document.getElementById('invtype'+i).value+"'>";
		   datahtml+="<input type=hidden name=F_nc_pk value='"+document.getElementById('F_nc_pk'+i).value+"'>";
		   datahtml+="<input type=hidden name=masname value='"+document.getElementById('masname'+i).value+"'>";
		   datahtml+="<input type=hidden name=F_number value='"+document.getElementById('F_number'+i).value+"'>";
		   datahtml+="<input type=hidden name=ERRU value='"+document.getElementById('ERRU'+i).value+"'>"; 
                   datahtml+="<input type=hidden name=ERRD value='"+document.getElementById('ERRD'+i).value+"'>"; 
		   datahtml+="<input type=hidden name=DIS value='"+document.getElementById('DIS'+i).value+"'>"; 
		   datahtml+="<input type=hidden name=DISNUM value='"+document.getElementById('DISNUM'+i).value+"'>"; 
		   datahtml+="<input type=hidden name=PROCID value='"+document.getElementById('PROCID'+i).value+"'>"; 
		   datahtml+="<input type=hidden name=CLSID value='"+document.getElementById('CLSID'+i).value+"'>"; 
		   datahtml+="<input type=hidden name=FLAG value='"+document.getElementById('FLAG'+i).value+"'>"; 
		   if(document.getElementById('invtype'+i).value == 'A'){
                       datahtml+="<input type=hidden name=fhwlbomid value=''>"; 
		       datahtml+="<input type=hidden name=ischild value='Y'>"; 
		   }else{
		       datahtml+="<input type=hidden name=fhwlbomid value='"+document.getElementById('fhwlbomid'+i).value+"'>"; 
		       datahtml+="<input type=hidden name=ischild value='N'>"; 
		   }
		}
	}
        if(datahtml==''){
            alert("没有可更新的数据！");
            return false;
        }
      subdata.innerHTML=datahtml+"<input type=hidden name=version value='"+document.form1.version.value+"'><input type=hidden name=bomid value='"+bomid+"'><input type=hidden name=remark value='"+document.form1.remark.value+"'><input type=hidden name=invnameid value='"+document.form1.invnameid.value+"'><input type=hidden name=bomname value='"+document.form1.bomname.value+"'><input type=hidden name=meaname value='"+document.form1.meaname.value+"'><input type=hidden name=hnum value='"+document.form1.hnum.value+"'><input type=hidden name=bomcls value='"+document.form1.bomcls.value+"'><input type=hidden name=prodline value='"+document.form1.prodline.value+"'><input type=hidden name=fstatus value='"+status+"'>";
      document.form1.target="dataframe";
      document.form1.action="testversion.aspx";
      document.form1.submit();
}
function testok(){
   document.all.thisform.action="invnamebomsaveadd.aspx";
   document.all.thisform.submit();
}
function togetmont(url){
    window.open(url,'','top='+(screen.height - 600) / 2 +',left='+(screen.width - 650) / 2 +',Toolbar=no,menubar=no,scrollbars=yes,status=yes,location=no,resizable=yes,directories=no,width=650,height=500');
 }
 function togetmont1(url,row){
     if(document.getElementById('F_nc_pk'+row).value==""){
        alert("原材料名称不能为空");
	return false;
     }
     if(document.getElementById('invtype'+row).value==""){
        
     }else if(document.getElementById('invtype'+row).value=="A"){
         alert("物料类型为自制复合物料或领用复合物料才能选择");
	 return false;
     }
      window.open(url,'','top='+(screen.height - 600) / 2 +',left='+(screen.width - 650) / 2 +',Toolbar=no,menubar=no,scrollbars=yes,status=yes,location=no,resizable=yes,directories=no,width=650,height=500');
 }
</script>
<link href="../../../css.css" rel="stylesheet" type="text/css">
</head>
<body onload="init()">
<br>
<table width="700" height="30"  border="0" align="center" cellpadding="0" cellspacing="0" class="B1">
  <tr>
    <td class="f" align="center">添加产品BOM</td>
  </tr>
</table>
<form name="form1" method='post'>  
<table width="100%" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#999999">
   <tr bgcolor="#E3E3E3" class="fCopy">
      <td height="24" width="10%" nowrap><div align="right">产品:</div></td>
      <td width="40%"><input type="text" name="invname" id="invname" style="width:300" value="$!form_yclinvname" readonly><input type="hidden" name="invnameid" id="invnameid" value="$m.PK_INVBASDOC"><input type="button" value="..." onclick="togetmont('itemdescquery.aspx')"></td>
      <td height="24" width="10%" nowrap><div align="right">物料类型:</div></td>
      <td width="40%">
           <select name="bomcls">
              <option value='A'>物料</option>
	   </select>
      </td>
   </tr>
   <tr bgcolor="#E3E3E3" class="fCopy">
      <td height="24" width="10%" nowrap><div align="right">版本号:</div></td>
      <td width="40%"><input type="text" name="version" value="#foreach($m in $snbomversionquery)$m.VERSION#end"></td>
      <td height="24" width="10%" nowrap><div align="right">BOM名称:</div></td>
      <td width="40%"><input type="text" name="bomname" style="width:300" value="$!form_yclinvname"></td>
   </tr>
   <tr bgcolor="#E3E3E3" class="fCopy">
      <td height="24" width="10%" nowrap><div align="right">计量单位:</div></td>
      <td width="40%"><select name="meaname" disabled>
       #foreach($m in $snmeasdocquery)
          <option value="$!m.PK_MEASDOC" #if($!form_pk_measdoc == $!m.PK_MEASDOC)selected#end>$!m.MEASNAME</option>
       #end
      </td>
      <td height="24" width="10%" nowrap><div align="right">基数:</div></td>
      <td width="40%"><input type="text" name="hnum" value="1" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')"></td>
   </tr>
   <tr bgcolor="#E3E3E3" class="fCopy">
      <td height="24" width="10%" nowrap><div align="right">备注:</div></td>
      <td colspan="3"><textarea  name="remark" style="width: 90%; height: 100px;"></textarea></td>
     <div align="right" style="display:none">
         <select name="prodline">
        <option value=""></option>
        #foreach($m in $snbomproclinequery)
          <option value="$!m.PROCLINEID">$!m.PROCLINENAME</option>
        #end</div>
   </tr>
</table>
<br>
<table width="100%" id="tb" border="1" align="center" cellpadding="0" cellspacing="1" bordercolor="#D4D0C8" bgcolor="#FFFFFF">
  <tr bgcolor="#E3E3E3" class="fCopy">
    <th width="1%" height="25" nowrap class="fCopy" style="display:none">产品主键</th>
    <th width="15%" height="25" nowrap><font color="red">原材料名称</font></th>
    <th width="5%" height="25" nowrap><font color="red">计量单位</font></th>
    <th width="5%" height="25" nowrap class="fCopy">物料类型</th>
    <th width="5%" height="25" nowrap class="fCopy">关联物料BOM</th>
    <th width="10%" height="25" nowrap><font color="red">单位用量</font></th>
    <th width="10%" height="25" nowrap class="fCopy">正误差率</th>
    <th width="10%" height="25" nowrap class="fCopy">负误差率</th>
    <th width="10%" height="25" nowrap class="fCopy">损耗率</th>
    <th width="10%" height="25" nowrap class="fCopy">固定损耗量</th>
    <th width="10%" height="25" nowrap class="fCopy" style="display:none">工序</th>
    <th width="5%" height="25" nowrap class="fCopy">参考类别</th>
    <th width="5%" height="25" nowrap class="fCopy">客户供应标识</th>
  </tr>
  <tr bgcolor="#FFFFFF" class="fCopy" id="A0">
     <td align="center" nowrap>
     <input name="invbasname" id="invbasname0" type="text" class="login3" style="width:200" value="" readonly><input type="button" value="..." onclick="togetmont('yclquery.aspx?row=0')">
      </td>
      <td style="display:none"><input name="F_nc_pk" id="F_nc_pk0" type="hidden" style="width:10" class='login3' readonly></td>
      <td align="center" nowrap>
         <select name="masname" id="masname0" disabled>
	       #foreach($m in $snmeasdocquery)
		  <option value="$!m.PK_MEASDOC">$!m.MEASNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="invtype" id="invtype0">
	 <option value="A">一般物料</option>
	 <option value="B">自制复合物料</option>
	 <option value="C">领用复合物料</option>
	 </select>
      </td>
      <td align="center" nowrap>
         <input type="text" style="width:70" name="fhwlbomid" id="fhwlbomid0" readonly><input type="button" value="..." onclick="togetmont1('fhwlbomquery.aspx?row=0&pk_invbasdoc='+document.getElementById('F_nc_pk0').value,0)">
      </td>
      <td align="center" nowrap>
         <input name="F_number" id="F_number0" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRU" id="ERRU0" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRD" id="ERRD0" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DIS" id="DIS0" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DISNUM" id="DISNUM0" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap style="display:none">
         <input name="PROCID" id="PROCID0" type="hidden" style="width:70">
      </td>
      <td align="center" nowrap>
         <select name="CLSID" id="CLSID0">
	 <option value=""></option>
	       #foreach($m in $snbompclsqueryall)
		  <option value="$!m.CLSID">$!m.CLSNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="FLAG" id="FLAG0">
	 <option value="Y">计算成本</option>
	 <option value="N">不计成本</option>
	 </select>
      </td>
  </tr>
  <tr><td colspan=11 style="padding:0px" ><table id="dtb"></table></td></tr>
  <tr bgcolor="#FFFFFF" class="fCopy" id="A1">
     <td align="center" nowrap>
     <input name="invbasname" id="invbasname1" type="text" class="login3" style="width:200" value="" readonly><input type="button" value="..." onclick="togetmont('yclquery.aspx?row=1')">
      </td>
      <td style="display:none"><input name="F_nc_pk" id="F_nc_pk1" type="hidden" style="width:10" class='login3' readonly></td>
      <td align="center" nowrap>
         <select name="masname" id="masname1" disabled>
	       #foreach($m in $snmeasdocquery)
		  <option value="$!m.PK_MEASDOC">$!m.MEASNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="invtype" id="invtype1">
	 <option value="A">一般物料</option>
	 <option value="B">自制复合物料</option>
	 <option value="C">领用复合物料</option>
	 </select>
      </td>
      <td align="center" nowrap>
         <input type="text" style="width:70" name="fhwlbomid" id="fhwlbomid1" readonly><input type="button" value="..." onclick="togetmont1('fhwlbomquery.aspx?row=1&pk_invbasdoc='+document.getElementById('F_nc_pk1').value,1)">
      </td>
      <td align="center" nowrap>
         <input name="F_number" id="F_number1" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRU" id="ERRU1" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRD" id="ERRD1" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DIS" id="DIS1" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DISNUM" id="DISNUM1" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap style="display:none">
         <input name="PROCID" id="PROCID1" type="hidden" style="width:70">
      </td>
      <td align="center" nowrap>
         <select name="CLSID" id="CLSID1">
	 <option value=""></option>
	       #foreach($m in $snbompclsqueryall)
		  <option value="$!m.CLSID">$!m.CLSNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="FLAG" id="FLAG1">
	 <option value="Y">计算成本</option>
	 <option value="N">不计成本</option>
	 </select>
      </td>
  </tr>
  <tr><td colspan=11 style="padding:0px" ><table id="dtb"></table></td></tr>

  <tr bgcolor="#FFFFFF" class="fCopy" id="A2">
     <td align="center" nowrap>
     <input name="invbasname" id="invbasname2" type="text" class="login3" style="width:200" value="" readonly><input type="button" value="..." onclick="togetmont('yclquery.aspx?row=2')">
      </td>
      <td style="display:none"><input name="F_nc_pk" id="F_nc_pk2" type="hidden" style="width:10" class='login3' readonly></td>
      <td align="center" nowrap>
         <select name="masname" id="masname2" disabled>
	       #foreach($m in $snmeasdocquery)
		  <option value="$!m.PK_MEASDOC">$!m.MEASNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="invtype" id="invtype2">
	 <option value="A">一般物料</option>
	 <option value="B">自制复合物料</option>
	 <option value="C">领用复合物料</option>
	 </select>
      </td>
      <td align="center" nowrap>
         <input type="text" style="width:70" name="fhwlbomid" id="fhwlbomid2" readonly><input type="button" value="..." onclick="togetmont1('fhwlbomquery.aspx?row=2&pk_invbasdoc='+document.getElementById('F_nc_pk2').value,2)">
      </td>
      <td align="center" nowrap>
         <input name="F_number" id="F_number2" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRU" id="ERRU2" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRD" id="ERRD2" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DIS" id="DIS2" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DISNUM" id="DISNUM2" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap style="display:none">
         <input name="PROCID" id="PROCID2" type="hidden" style="width:70">
      </td>
      <td align="center" nowrap>
         <select name="CLSID" id="CLSID2">
	 <option value=""></option>
	       #foreach($m in $snbompclsqueryall)
		  <option value="$!m.CLSID">$!m.CLSNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="FLAG" id="FLAG2">
	 <option value="Y">计算成本</option>
	 <option value="N">不计成本</option>
	 </select>
      </td>
  </tr>
  <tr><td colspan=11 style="padding:0px" ><table id="dtb"></table></td></tr>

  <tr bgcolor="#FFFFFF" class="fCopy" id="A3">
     <td align="center" nowrap>
     <input name="invbasname" id="invbasname3" type="text" class="login3" style="width:200" value="" readonly><input type="button" value="..." onclick="togetmont('yclquery.aspx?row=3')">
      </td>
      <td style="display:none"><input name="F_nc_pk" id="F_nc_pk3" type="hidden" style="width:10" class='login3' readonly></td>
      <td align="center" nowrap>
         <select name="masname" id="masname3" disabled>
	       #foreach($m in $snmeasdocquery)
		  <option value="$!m.PK_MEASDOC">$!m.MEASNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="invtype" id="invtype3">
	 <option value="A">一般物料</option>
	 <option value="B">自制复合物料</option>
	 <option value="C">领用复合物料</option>
	 </select>
      </td>
      <td align="center" nowrap>
         <input type="text" style="width:70" name="fhwlbomid" id="fhwlbomid3" readonly><input type="button" value="..." onclick="togetmont1('fhwlbomquery.aspx?row=3&pk_invbasdoc='+document.getElementById('F_nc_pk3').value,3)">
      </td>
      <td align="center" nowrap>
         <input name="F_number" id="F_number3" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRU" id="ERRU3" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRD" id="ERRD3" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DIS" id="DIS3" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DISNUM" id="DISNUM3" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap style="display:none">
         <input name="PROCID" id="PROCID3" type="hidden" style="width:70">
      </td>
      <td align="center" nowrap>
         <select name="CLSID" id="CLSID3">
	 <option value=""></option>
	       #foreach($m in $snbompclsqueryall)
		  <option value="$!m.CLSID">$!m.CLSNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="FLAG" id="FLAG3">
	 <option value="Y">计算成本</option>
	 <option value="N">不计成本</option>
	 </select>
      </td>
  </tr>
  <tr><td colspan=11 style="padding:0px" ><table id="dtb"></table></td></tr>

  <tr bgcolor="#FFFFFF" class="fCopy" id="A4">
     <td align="center" nowrap>
     <input name="invbasname" id="invbasname4" type="text" class="login3" style="width:200" value="" readonly><input type="button" value="..." onclick="togetmont('yclquery.aspx?row=4')">
      </td>
      <td style="display:none"><input name="F_nc_pk" id="F_nc_pk4" type="hidden" style="width:10" class='login3' readonly></td>
      <td align="center" nowrap>
         <select name="masname" id="masname4" disabled>
	       #foreach($m in $snmeasdocquery)
		  <option value="$!m.PK_MEASDOC">$!m.MEASNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="invtype" id="invtype4">
	 <option value="A">一般物料</option>
	 <option value="B">自制复合物料</option>
	 <option value="C">领用复合物料</option>
	 </select>
      </td>
      <td align="center" nowrap>
         <input type="text" style="width:70" name="fhwlbomid" id="fhwlbomid4" readonly><input type="button" value="..." onclick="togetmont1('fhwlbomquery.aspx?row=4&pk_invbasdoc='+document.getElementById('F_nc_pk4').value,4)">
      </td>
      <td align="center" nowrap>
         <input name="F_number" id="F_number4" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRU" id="ERRU4" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRD" id="ERRD4" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DIS" id="DIS4" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DISNUM" id="DISNUM4" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap style="display:none">
         <input name="PROCID" id="PROCID4" type="hidden" style="width:70">
      </td>
      <td align="center" nowrap>
         <select name="CLSID" id="CLSID4">
	 <option value=""></option>
	       #foreach($m in $snbompclsqueryall)
		  <option value="$!m.CLSID">$!m.CLSNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="FLAG" id="FLAG4">
	 <option value="Y">计算成本</option>
	 <option value="N">不计成本</option>
	 </select>
      </td>
  </tr>
  <tr><td colspan=11 style="padding:0px" ><table id="dtb"></table></td></tr>

  <tr bgcolor="#FFFFFF" class="fCopy" id="A5">
     <td align="center" nowrap>
     <input name="invbasname" id="invbasname5" type="text" class="login3" style="width:200" value="" readonly><input type="button" value="..." onclick="togetmont('yclquery.aspx?row=5')">
      </td>
      <td style="display:none"><input name="F_nc_pk" id="F_nc_pk5" type="hidden" style="width:10" class='login3' readonly></td>
      <td align="center" nowrap>
         <select name="masname" id="masname5" disabled>
	       #foreach($m in $snmeasdocquery)
		  <option value="$!m.PK_MEASDOC">$!m.MEASNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="invtype" id="invtype5">
	 <option value="A">一般物料</option>
	 <option value="B">自制复合物料</option>
	 <option value="C">领用复合物料</option>
	 </select>
      </td>
      <td align="center" nowrap>
         <input type="text" style="width:70" name="fhwlbomid" id="fhwlbomid5" readonly><input type="button" value="..." onclick="togetmont1('fhwlbomquery.aspx?row=5&pk_invbasdoc='+document.getElementById('F_nc_pk5').value,5)">
      </td>
      <td align="center" nowrap>
         <input name="F_number" id="F_number5" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRU" id="ERRU5" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRD" id="ERRD5" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DIS" id="DIS5" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DISNUM" id="DISNUM5" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap style="display:none">
         <input name="PROCID" id="PROCID5" type="hidden" style="width:70">
      </td>
      <td align="center" nowrap>
         <select name="CLSID" id="CLSID5">
	 <option value=""></option>
	       #foreach($m in $snbompclsqueryall)
		  <option value="$!m.CLSID">$!m.CLSNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="FLAG" id="FLAG5">
	 <option value="Y">计算成本</option>
	 <option value="N">不计成本</option>
	 </select>
      </td>
  </tr>
  <tr><td colspan=11 style="padding:0px" ><table id="dtb"></table></td></tr>

  <tr bgcolor="#FFFFFF" class="fCopy" id="A6">
     <td align="center" nowrap>
     <input name="invbasname" id="invbasname6" type="text" class="login3" style="width:200" value="" readonly><input type="button" value="..." onclick="togetmont('yclquery.aspx?row=6')">
      </td>
      <td style="display:none"><input name="F_nc_pk" id="F_nc_pk6" type="hidden" style="width:10" class='login3' readonly></td>
      <td align="center" nowrap>
         <select name="masname" id="masname6" disabled>
	       #foreach($m in $snmeasdocquery)
		  <option value="$!m.PK_MEASDOC">$!m.MEASNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="invtype" id="invtype6">
	 <option value="A">一般物料</option>
	 <option value="B">自制复合物料</option>
	 <option value="C">领用复合物料</option>
	 </select>
      </td>
      <td align="center" nowrap>
         <input type="text" style="width:70" name="fhwlbomid" id="fhwlbomid6" readonly><input type="button" value="..." onclick="togetmont1('fhwlbomquery.aspx?row=6&pk_invbasdoc='+document.getElementById('F_nc_pk6').value,6)">
      </td>
      <td align="center" nowrap>
         <input name="F_number" id="F_number6" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRU" id="ERRU6" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRD" id="ERRD6" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DIS" id="DIS6" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DISNUM" id="DISNUM0" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap style="display:none">
         <input name="PROCID" id="PROCID6" type="hidden" style="width:70">
      </td>
      <td align="center" nowrap>
         <select name="CLSID" id="CLSID6">
	 <option value=""></option>
	       #foreach($m in $snbompclsqueryall)
		  <option value="$!m.CLSID">$!m.CLSNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="FLAG" id="FLAG6">
	 <option value="Y">计算成本</option>
	 <option value="N">不计成本</option>
	 </select>
      </td>
  </tr>
  <tr><td colspan=11 style="padding:0px" ><table id="dtb"></table></td></tr>

  <tr bgcolor="#FFFFFF" class="fCopy" id="A7">
     <td align="center" nowrap>
     <input name="invbasname" id="invbasname7" type="text" class="login3" style="width:200" value="" readonly><input type="button" value="..." onclick="togetmont('yclquery.aspx?row=7')">
      </td>
      <td style="display:none"><input name="F_nc_pk" id="F_nc_pk7" type="hidden" style="width:10" class='login3' readonly></td>
      <td align="center" nowrap>
         <select name="masname" id="masname7" disabled>
	       #foreach($m in $snmeasdocquery)
		  <option value="$!m.PK_MEASDOC">$!m.MEASNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="invtype" id="invtype7">
	 <option value="A">一般物料</option>
	 <option value="B">自制复合物料</option>
	 <option value="C">领用复合物料</option>
	 </select>
      </td>
      <td align="center" nowrap>
         <input type="text" style="width:70" name="fhwlbomid" id="fhwlbomid7" readonly><input type="button" value="..." onclick="togetmont1('fhwlbomquery.aspx?row=7&pk_invbasdoc='+document.getElementById('F_nc_pk7').value,7)">
      </td>
      <td align="center" nowrap>
         <input name="F_number" id="F_number7" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRU" id="ERRU7" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRD" id="ERRD7" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DIS" id="DIS7" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DISNUM" id="DISNUM7" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap style="display:none">
         <input name="PROCID" id="PROCID7" type="hidden" style="width:70">
      </td>
      <td align="center" nowrap>
         <select name="CLSID" id="CLSID7">
	 <option value=""></option>
	       #foreach($m in $snbompclsqueryall)
		  <option value="$!m.CLSID">$!m.CLSNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="FLAG" id="FLAG7">
	 <option value="Y">计算成本</option>
	 <option value="N">不计成本</option>
	 </select>
      </td>
  </tr>
  <tr><td colspan=11 style="padding:0px" ><table id="dtb"></table></td></tr>

  <tr bgcolor="#FFFFFF" class="fCopy" id="A8">
     <td align="center" nowrap>
     <input name="invbasname" id="invbasname8" type="text" class="login3" style="width:200" value="" readonly><input type="button" value="..." onclick="togetmont('yclquery.aspx?row=8')">
      </td>
      <td style="display:none"><input name="F_nc_pk" id="F_nc_pk8" type="hidden" style="width:10" class='login3' readonly></td>
      <td align="center" nowrap>
         <select name="masname" id="masname8" disabled>
	       #foreach($m in $snmeasdocquery)
		  <option value="$!m.PK_MEASDOC">$!m.MEASNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="invtype" id="invtype8">
	 <option value="A">一般物料</option>
	 <option value="B">自制复合物料</option>
	 <option value="C">领用复合物料</option>
	 </select>
      </td>
      <td align="center" nowrap>
         <input type="text" style="width:70" name="fhwlbomid" id="fhwlbomid8" readonly><input type="button" value="..." onclick="togetmont1('fhwlbomquery.aspx?row=8&pk_invbasdoc='+document.getElementById('F_nc_pk8').value,8)">
      </td>
      <td align="center" nowrap>
         <input name="F_number" id="F_number8" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRU" id="ERRU8" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRD" id="ERRD8" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DIS" id="DIS8" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DISNUM" id="DISNUM8" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap style="display:none">
         <input name="PROCID" id="PROCID8" type="hidden" style="width:70">
      </td>
      <td align="center" nowrap>
         <select name="CLSID" id="CLSID8">
	 <option value=""></option>
	       #foreach($m in $snbompclsqueryall)
		  <option value="$!m.CLSID">$!m.CLSNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="FLAG" id="FLAG8">
	 <option value="Y">计算成本</option>
	 <option value="N">不计成本</option>
	 </select>
      </td>
  </tr>
  <tr><td colspan=11 style="padding:0px" ><table id="dtb"></table></td></tr>

  <tr bgcolor="#FFFFFF" class="fCopy" id="A9">
     <td align="center" nowrap>
     <input name="invbasname" id="invbasname9" type="text" class="login3" style="width:200" value="" readonly><input type="button" value="..." onclick="togetmont('yclquery.aspx?row=9')">
      </td>
      <td style="display:none"><input name="F_nc_pk" id="F_nc_pk9" type="hidden" style="width:10" class='login3' readonly></td>
      <td align="center" nowrap>
         <select name="masname" id="masname9" disabled>
	       #foreach($m in $snmeasdocquery)
		  <option value="$!m.PK_MEASDOC">$!m.MEASNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="invtype" id="invtype9">
	 <option value="A">一般物料</option>
	 <option value="B">自制复合物料</option>
	 <option value="C">领用复合物料</option>
	 </select>
      </td>
      <td align="center" nowrap>
         <input type="text" style="width:70" name="fhwlbomid" id="fhwlbomid9" readonly><input type="button" value="..." onclick="togetmont1('fhwlbomquery.aspx?row=9&pk_invbasdoc='+document.getElementById('F_nc_pk9').value,9)">
      </td>
      <td align="center" nowrap>
         <input name="F_number" id="F_number9" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRU" id="ERRU9" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="ERRD" id="ERRD9" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DIS" id="DIS9" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap>
         <input name="DISNUM" id="DISNUM9" type="text" class="login3" style="width:70" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')">
      </td>
      <td align="center" nowrap style="display:none">
         <input name="PROCID" id="PROCID9" type="hidden" style="width:70">
      </td>
      <td align="center" nowrap>
         <select name="CLSID" id="CLSID9">
	 <option value=""></option>
	       #foreach($m in $snbompclsqueryall)
		  <option value="$!m.CLSID">$!m.CLSNAME</option>
	       #end
	 </select>
      </td>
      <td align="center" nowrap>
         <select name="FLAG" id="FLAG9">
	 <option value="Y">计算成本</option>
	 <option value="N">不计成本</option>
	 </select>
      </td>
  </tr>
  <tr><td colspan=11 style="padding:0px" ><table id="dtb"></table></td></tr>
  </table>
   <div align="center">
<input type="button" class="login2" value=" 保  存 " name="B22" onclick="save('N')">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<input type="button" class="login2" value=" 提  交 " name="B22" onclick="save('Y')">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<input type="button" class="login2" value=" 添加行 " name="B222" onClick="addRow();">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<input type="button" class="login2" value="返  回" name="B222" onClick="javascript:location.href='invnamebom.aspx'">
  </div>
</form>
<form name="thisform" action="" method="post" target="dataframe">
<span id="subdata"></span>
</form>
<iframe name="dataframe" src="" width="0" height="0"></iframe>
</body> 
</html>      
