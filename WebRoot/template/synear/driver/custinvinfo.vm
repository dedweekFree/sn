<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<link rel="stylesheet" type="text/css" href="../../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../../js/spellCode.css">
<script src="../../inc/js/pubjs.js"></script>
<script src="../../inc/js/preAfter.js"></script>
<link rel='StyleSheet' href='../../js/dtree.css' type='text/css' />
<title>客户产品明细</title>
<script language="javascript">
        var num1=0;
	 var num2=0;
	  var num3=0;
	 function toadd(url){
	    document.form2.action=url;
	    document.form2.submit();
	 }
	 function ShowDate(idText){
	 var state="dialogHeight: 300px; dialogWidth: 240px; dialogTop: 200px; dialogLeft: 300px; "+             "edge: Raised;  center: Yes; help: No; resizable: Yes; status: No;";
	 var reValue=window.showModalDialog('../../../js/date.html?OpenForm',"myDate",state);
	 if(reValue==null) 
		   ;
		 else
		   idText.value=reValue;
	    }

	    function todel(url){
	       if(confirm("确认要删除吗？")){
		      document.form2.target="saveframe";
		      document.form2.action=url;
		      document.form2.submit();
	      }
	    }
	    function toprint(url){
	       window.open(url,'','top='+(screen.height - 600) / 2 +',left='+(screen.width - 650) / 2 +',Toolbar=no,menubar=no,scrollbars=yes,status=yes,location=no,resizable=yes,directories=no,width=650,height=500');
	    }
	    function sub(){
		window.close();
	   }
	   function openwin(url){
		    window.open(url,'','top=0,left=0,Toolbar=no,menubar=no,scrollbars=yes,status=yes,location=no,resizable=yes,directories=no,width="+screen.width+",height="+screen.height+"');
		}
	function toprint(url){
		    window.open(url,'','top='+(screen.height - 600) / 2 +',left='+(screen.width - 650) / 2 +',Toolbar=no,menubar=no,scrollbars=yes,status=yes,location=no,resizable=yes,directories=no,width=650,height=500');
		}
         function init()
	{
	      var ss = "";
	      #foreach($m in $custsendgoodsdetailcust)
	      try{
		  eval("document.all.A${m.INVCODE}B${m.STORCODE}C${m.CUSTCODE}.innerText='$m.NSHOULDOUTNUM'");
	      }catch(e){}
	      #end
	      #foreach($m in $custsendgoodsdetailcustsum)
	      try{
		  eval("document.all.CSS${m.CUSTCODE}.innerText='$m.NSHOULDOUTNUM'");
	      }catch(e){}
	      #end
	      #foreach($m in $custsendgoodsdetailcust11)
	      try{
		  eval("document.all.AAA${m.INVCODE}BBB${m.STORCODE}.innerText='$m.NSHOULDOUTNUM'");
	      }catch(e){}
	      #end

	/*	for(var i=0;i<document.all.thisform.calbody2.options.length;i++){ 
			if(document.all.thisform.calbody.value.indexOf(document.all.thisform.calbody2.options[i].value)>-1){
			     document.all.thisform.calbody2.options[i].selected=true;
			}
		} */
	}
	NS4 = (document.layers) ? 1 : 0; 
	visble_property_prefix = (NS4) ? "document.layers." : ""; 
	visble_property_suffix = (NS4) ? ".visibility" : ".style.display"; 
	visble_property_true = (NS4) ? "show" : "block"; 
	visble_property_false = (NS4) ? "hide" : "none"; 
	visble_property_printview = visble_property_prefix + "viewpanel" + visble_property_suffix; 
	function nowprint() { 
	 window.print(); 
	} 
	function window.onbeforeprint() { 
	 eval(visble_property_printview + " = \"" + visble_property_false + "\""); 
	} 
	function window.onafterprint() { 
	 eval(visble_property_printview + " = \"" + visble_property_true + "\""); 
	} 
</script>
</head>

<body onload="init();">
<div id="viewpanel" align="center"> 
   <input type="button" name="b1" class="bt1" value="关  闭" onclick="sub()"/>&nbsp;<input type="button" class="bt1" name="btn" value="导出excel表"onclick="javascript:method1('tb');">&nbsp;<input name="bequery" type="button" value="打 印" style="cursor:hand;" class="bt1" onclick="nowprint();"></td>
</div>
<p align="center">#if($!form_address=="chenzhai")陈砦#elseif($!form_address=="sinian")思念#end$!form_ordercode预拣货单</p>
<table class="datatable" id="tb">
  <tr class="trcolor">
    <td>仓库名称</td>
    <td>产品编码</td>
    <td>产品名称</td>
    <td>产品规格</td>
    #foreach($!m in $custsendgoodsdetailcustname)
    <td>$m.CUSTNAME</td>
    #end
    <td>合计</td>
  </tr>
  #set($i=1)
  #foreach($!m in $custsendgoodsdetailcustnameinvname)
  <tr class="trcolor">
    <td nowrap>$!m.STORNAME</td>
    <td>$!m.INVCODE</td>
    <td>$!m.INVNAME</td>
    <td>$!m.INVSPEC</td>
    #foreach($n in $custsendgoodsdetailcustname)
      <td id="A${m.INVCODE}B${m.STORCODE}C${n.CUSTCODE}">0</td>
      <script>//alert("A${m.INVCODE}B${m.STORCODE}C${n.CUSTCODE}")</script>
    #end
    <td id="AAA${m.INVCODE}BBB${m.STORCODE}">0</td>
  </tr>
  #set($i=$i+1)
  #end
  <tr>
      <td align="center" colspan="4">合计</td>
      #foreach($n in $custsendgoodsdetailcustname)
      <td align="center" id="CSS${n.CUSTCODE}">0</td>
    #end
    <td align="center">
        #foreach($n in $custsendgoodsdetailcustsum11)
        $!n.NSHOULDOUTNUM
    #end
    </td>
  </tr>
</table>
<form method="post" name="form2">
</form>
<iframe name="saveframe" src="about:blank" width="100%" height="0" noresize frameborder=0 framespacing=0 

marginheight=0 marginwidth=0></iframe>
</body>
</html>
<script>
function method1(tableid) {//整个表格拷贝到EXCEL中 
    var curTbl = document.getElementById(tableid); 
    var oXL = new ActiveXObject("Excel.Application"); 
    //创建AX对象excel 
    var oWB = oXL.Workbooks.Add(); 
    //获取workbook对象 
        var oSheet = oWB.ActiveSheet; 
    //激活当前sheet 
    var sel = document.body.createTextRange(); 
    sel.moveToElementText(curTbl); 
    //把表格中的内容移到TextRange中 
    sel.select(); 
    //全选TextRange中内容 
    sel.execCommand("Copy"); 
    //复制TextRange中内容  
    oSheet.Paste(); 
    //粘贴到活动的EXCEL中       
    oXL.Visible = true; 
    //设置excel可见属性 
} 
</script>