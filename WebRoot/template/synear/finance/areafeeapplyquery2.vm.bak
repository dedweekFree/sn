<html>
<head>
<title>======</title>
<link rel="stylesheet" type="text/css" href="../../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../../js/spellCode.css">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<script src="../../../js/sunnyfunc.js"></script>
<script src="../../../js/string.js"></script>
<style> 
.FixedTitleRow 
{ 
position: relative; 
top: expression(this.offsetParent.scrollTop-2); 
z-index: 10; 
background-color: #E6ECF0; 
} 
.FixedTitleColumn 
{ 
position: relative; 
left: expression(this.parentElement.offsetParent.scrollLeft); 
} 
.FixedDataColumn 
{ 
position: relative; 
left: expression(this.parentElement.offsetParent.parentElement.scrollLeft); 
} 
.mainDiv    
{    
overflow:auto;    
scrollbar-face-color:9999ff; 
height:expression((document.body.clientHeight-this.offsetTop-20>this.children[0].offsetHeight)?(this.children[0].offsetHeight+20)   :   (document.body.clientHeight-this.offsetTop-20));    
width:expression((document.body.clientWidth-this.offsetLeft));   
}
</style> 
<script>
var undefined;

function init(){
  uniteCols(document.all.tb);//执行
}

function uniteTable(thistab,colLength){   
  var   rn=thistab.rows.length;//取得行数   
  var   rowspann=0;   
  for(j=colLength-1;j>=0;j--){//从第0列开始，合并多少列   
    for(i=rn-1;i>0;i--){//从倒数第一行开始往上检查   
      if(thistab.rows[i].cells[j].innerText==thistab.rows[i-1].cells[j].innerText&&thistab.rows[i].cells[j].colSpan==thistab.rows[i-1].cells[j].colSpan){//与上面一行比较，如果两行相等就合计当前行的合并行数，并删除当前行。   
        rowspann+=thistab.rows[i].cells[j].rowSpan;   
        thistab.rows[i].deleteCell(j);   
      }else{   
        thistab.rows[i].cells[j].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。   
        rowspann=0;   
      }   
    }   
    //检测无表头的表   
    if(i==0&&rowspann>0){   
      thistab.rows[i].cells[j].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。   
      rowspann=0;   
    }   
    
  }   
}  
//本业务合并
function uniteCols(thistab){   
  var   rn=thistab.rows.length;//取得行数   
  var   rowspann=0;   
  for(i=rn-1;i>0;i--){//从倒数第一行开始往上检查   
      if(thistab.rows[i].cells[0].innerText==thistab.rows[i-1].cells[0].innerText&&thistab.rows[i].cells[0].colSpan==thistab.rows[i-1].cells[0].colSpan){//与上面一行比较，如果两行相等就合计当前行的合并行数，并删除当前行。   
        rowspann+=thistab.rows[i].cells[0].rowSpan;   
        thistab.rows[i].deleteCell(0);  
	thistab.rows[i].deleteCell(4);
	thistab.rows[i].deleteCell(4);
	thistab.rows[i].deleteCell(4);
	thistab.rows[i].deleteCell(4);
      }else{   
        thistab.rows[i].cells[0].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。
	thistab.rows[i].cells[5].rowSpan+=rowspann;
	thistab.rows[i].cells[6].rowSpan+=rowspann;
	thistab.rows[i].cells[7].rowSpan+=rowspann;
	thistab.rows[i].cells[8].rowSpan+=rowspann;
        rowspann=0;   
      }   
  }   
  //检测无表头的表   
  if(i==0&&rowspann>0){   
        thistab.rows[i].cells[0].rowSpan+=rowspann;//如果不等就完成当前相同数据的合并。
        thistab.rows[i].cells[5].rowSpan+=rowspann;
        thistab.rows[i].cells[6].rowSpan+=rowspann;
	thistab.rows[i].cells[7].rowSpan+=rowspann;
	thistab.rows[i].cells[8].rowSpan+=rowspann;
      rowspann=0;   
  }   
} 

function setvalue(step,status){
  document.form1.step.value=step;
  document.form1.status.value=status;
  document.form1.submit();
}

</script>

</head>
<body onload="init()">
<br>
<table width="700" height="30"  border="0" align="center" cellpadding="0" cellspacing="0" class="B1">
  <tr>
    <td class="f">&nbsp;&nbsp; <div align="center" class="style1"> #foreach($m in $areafeeapplyquery) $!m.APPLYMONTH $!m.DEPTNAME 费用申请表 #end </div></td>
  </tr>
</table>
<table width="90%"  border="0" align="center" cellpadding="0" cellspacing="0">
<tr><td height="30"></td></tr>
</table>

<!--<div id="scrollDiv" style="width:expression((document.body.clientWidth-this.offsetLeft)); overflow: auto; cursor: default; display: inline; 
position: absolute;height:expression((document.body.clientHeight-this.offsetTop))"> -->
<div class="mainDiv" id="mdiv"> 
<table id="tb" width="90%" border="0" cellspacing="0" cellpadding="0" bgcolor="ffffff"  class="datatable">
  <tr bgcolor="abcdef"  class="FixedTitleRow">
    <th width="18%" class="FixedTitleColumn" height="25" nowrap>客户名称</th>
    <th width="8%" class="FixedTitleColumn" height="25" nowrap>部门</th>
    <th width="8%" class="FixedTitleColumn" height="25" nowrap>产品类别</th>
    <th width="8%" class="FixedTitleColumn" height="25" nowrap>产品费用预算</th>
    <th width="8%" height="25" nowrap>说明</th>
    <th width="8%" height="25" nowrap>终端费用预算</th>
    <th width="8%" height="25" nowrap>返利预算</th>
    <th width="8%" height="25" nowrap>备注</th>
    <th width="8%" height="25" nowrap>费用预算合计</th>
  </tr>
 #set($i=0)
 #foreach($m in $areafeeapplyquery2)
  <tr class="trcolor">
      <td align="center" class="FixedDataColumn" nowrap>$!m.CUSTNAME</td>
      <td align="center" class="FixedDataColumn" nowrap>$!m.DEPTNAME</td>
      <td align="center" class="FixedDataColumn" nowrap>$!m.INVCLASSNAME</td>
       <td align="center"  class="FixedDataColumn" nowrap>$!m.PRE_PRODUCTFEE</td>
        <td align="center" nowrap>$!m.REMARK &nbsp;</td>
        <td align="center" nowrap>$!m.PRE_ENDFEE</td>
      <td align="center" nowrap>$!m.PRE_RETURN</td>
      <td align="center" nowrap>$!m.HREMARK &nbsp;</td>
        <td align="center" nowrap>$!m.PRE_ALLFEE</td>
 </tr>
  #set($i=$i+1)
 #end
 #foreach($m in $areafeeapplyquery)
  <tr class="trcolor">
      <td align="center" class="FixedDataColumn" nowrap>合计</td>
      <td align="center" class="FixedDataColumn" nowrap>&nbsp;</td>
      <td align="center" class="FixedDataColumn" nowrap>&nbsp;</td>
       <td align="center" class="FixedDataColumn" nowrap>$!m.PRE_PRODFEE</td>
        <td align="center" nowrap>&nbsp;</td>
        <td align="center" nowrap>$!m.PRE_ENDFEE</td>
      <td align="center" nowrap>$!m.PRE_RETURN</td>
      <td align="center" nowrap>&nbsp;</td>
        <td align="center" nowrap>$!m.PRE_ALLFEE</td>
 </tr>
 #end
  </table>

 <br>
  <div align="center">审核记录</div>
  <table width="90%" border="0" cellspacing="0" cellpadding="0" bgcolor="ffffff"  class="datatable">
  <tr class="trtitle" bgcolor="abcdef">
    <th width="8%" height="25" nowrap>审核时间</th>
    <th width="8%" height="25" nowrap>审核人</th>
    <th width="8%" height="25" nowrap>审核结果</th>
    <th width="58%" height="25" nowrap>审核意见</th>
  </tr>
 #foreach($m in $getAudiRemark)
  <tr class="trcolor">
      <td align="center" nowrap>$!m.AUDIDATE</td>
      <td align="center" nowrap>$!m.NAME</td>
      <td align="center" nowrap><script>'$!m.AUDISTATUS'.toRealText('F','同意','不同意').write()</script></td>
      <td align="center" nowrap>$!m.REMARK &nbsp;</td>
 </tr>
 #end
  </table> 

 <div align="center">
<input type="button" class="login2" value=" 返  回 " name="B222" onClick="javascript:history.go(-1);">
  </div>
    </div> 
<iframe name="dataframe" src="" width="0" height="0"></iframe>

</body> 
</html>      
