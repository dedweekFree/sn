<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<link rel="stylesheet" type="text/css" href="../../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../../js/spellCode.css">
<title>======</title>
<script language="javascript">
function ShowDate(idText){
	 var state="dialogHeight: 300px; dialogWidth: 240px; dialogTop: 200px; dialogLeft: 300px; "+             "edge: Raised;  center: Yes; help: No; resizable: Yes; status: No;";
	 var reValue=window.showModalDialog('../../../js/date.html?OpenForm',"myDate",state);
	 if(reValue==null) 
	   ;
	 else
	   idText.value=reValue;
	 }
</script>
</head>

<body>
<form name="form1" action="PurchaseMoneyDetail2.aspx" method="post">
<table class="datatable">
  <tr class="trcolor">
    <td colspan="5" align="left">对账查询</td>
  </tr>
   <tr class="trcolor">
    <td>对账日期:</td>
    <td align="left"><input type="text" name="TextZhiDanRiQi1y1" onclick="ShowDate(TextZhiDanRiQi1y1)" value="$!form_TextZhiDanRiQi1y1"/>-<input name="TextZhiDanRiQi1y2" type="text" onclick="ShowDate(TextZhiDanRiQi1y2)"  value="$!form_TextZhiDanRiQi1y2"/></td>
    <td>产品名称&nbsp;</td>
    <td><input type="text" name="invname" value="$form_invname"></td>
    <td>&nbsp;</td>
  </tr>
  <tr class="trcolor">
  <td>供应商编码:</td>
  <td align="left"><input type="text" name="custcode" value="$!form_custcode"></td>
  <td>供应商名称</td>
  <td><input type="text" name="custname" value="$!form_custname"></td>
  <td><input type="submit" name="Submit" class="bt1" value="查&nbsp;&nbsp;询" /></td>
  </tr>
</table>
</form>
<br>
<table class="datatable" id="table1" border="1">
  <tr class="trcolor">
    <td>供应商名称</td>
    <td>发票号</td>
    <td>发票日期</td>
    <td>订单号</td>
    <td>到货单号</td>
    <td>订单日期</td>
    <td>存货名称</td>
    <td>到货仓库</td>
    <td>到货地点</td>
    <td>价格</td>
    <td>发票数量</td>
    <td>金额</td>
  </tr>
  #set($i=0)
  #foreach($!m in $selPurchaseMoneyDetail2)
  <tr class="trcolor">
    <td>$!m.CUSTNAME</td>
    <td>$!m.VINVOICECODE</td>
    <td>$!m.DINVOICEDATE</td>
    <td>$!m.VORDERCODE</td>
    <td>$!m.VARRORDERCODE</td>
    <td>$!m.DORDERDATE</td>
    <td>$!m.INVNAME</td>
    <td>$!m.STORNAME</td>
    <td>$!m.VDEF4</td>
    <td>$!m.NORGNETTAXPRICE</td>
    <td>$!m.NINVOICENUM</td>
    <td>$!m.NORIGINALSUMMNY</td>
  </tr>
  #set($i=$i+1)
  #end
  <tr class="trcolor">
	<td colspan="10" align="left">退货数量</td>
  </tr>
  <tr class="trcolor">
        <td>供应商名称</td>
	<td>发票号</td>
	<td>发票日期</td>
	<td>订单号</td>
	<td>订单日期</td>
	<td >存货名称</td>
	<td>到货地点</td>
	<td>价格</td>
	<td>退货发票数量</td>
	<td>退货金额</td>
  </tr>
#foreach($!m in $selbackinvoice2xx) 
	#if($!m.VINVOICECODE !='' && $!m.DINVOICEDATE !='' && $!m.NINVOICENUM !='' && $!m.NORIGINALSUMMNY !='' && $!m.CUSTNAME !=''  && $!m.INVNAME !='' )
		  <tr class="trcolor">
			<td>$!m.CUSTNAME</td>
			<td>$!m.VINVOICECODE</td>
			<td>$!m.DINVOICEDATE</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>$!m.INVNAME</td>
			<td>&nbsp;</td>
			<td>$!m.NORGNETTAXPRICE</td>
			<td>$!m.NINVOICENUM</td>
			<td>$!m.NORIGINALSUMMNY</td>
		  </tr>
	#else
	#end
	#if($!m.VINVOICECODE =='' && $!m.DINVOICEDATE =='' && $!m.NINVOICENUM !='' && $!m.NORIGINALSUMMNY !='' && $!m.CUSTNAME ==''  && $!m.INVNAME =='' )
		  <tr class="trcolor">
			<td colspan="8" align="right">小计:</td>
			<td id="B{$!m.VINVOICECODE}">$!m.NINVOICENUM</td>
			<td id="A{$!m.VINVOICECODE}">$!m.NORIGINALSUMMNY</td>
		  </tr>
	#else
	#end

#end
  <tr>
  <td colspan="12">
  <input name="b2" type="button" class="bt1" value="导出EXCEL表" onclick="javascript:method1('table1');"/>
  <input type="button" class="bt1" name="back" value="返&nbsp;&nbsp回" onclick="javascript:history.go(-1)"></td>
  </tr>
</table>
</body>
</html>
<script>
function method1(tableid) {//整个表格拷贝到EXCEL中 
    var curTbl = document.getElementById(tableid); 
    var oXL = new ActiveXObject("Excel.Application"); 
    //创建AX对象excel 
    var oWB = oXL.Workbooks.Add(); 
    //获取workbook对象 
        var oSheet = oWB.ActiveSheet; 
    //激活当前sheet 
    var sel = document.body.createTextRange(); 
    sel.moveToElementText(curTbl); 
    //把表格中的内容移到TextRange中 
    sel.select(); 
    //全选TextRange中内容 
    sel.execCommand("Copy"); 
    //复制TextRange中内容  
    oSheet.Paste(); 
    //粘贴到活动的EXCEL中       
    oXL.Visible = true; 
    //设置excel可见属性 
} 
</script>