
<html>
<head>
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache">
<META HTTP-EQUIV="Expires" CONTENT="0">
<link rel="stylesheet" type="text/css" href="../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../js/spellCode.css">
<meta http-equiv="Content-Type" content="text/html; charset=GBK">
<script Language="JavaScript" src="../../../include/js/PopCalendar.js"></script>
<script Language="javascript" src="../../../include/js/public.js"></script>
<script Language="javascript" src="../../../include/js/string.js"></script>
<script type="text/javascript" src="../../../inc/js/array2.js"></script>
<script  src="../../../inc/js/treePicker.js" language="javascript"></script>

<script src="../../../inc/js/pubjs.js"></script>
<script src="../../../inc/js/preAfter.js"></script>

<title>出库统计报表</title>
</head>
<SCRIPT LANGUAGE="JavaScript">

   var person=new Array(); 
   data=new data1('仓库主键','仓库名称','分厂主键');
   person.add(data);
#foreach($m in $sql1)
   data=new data1("$!m.PK_STORDOC","$!m.STORNAME","$!m.PK_FATHERCODE");
   person.add(data);
#end


var dates = new Date(); 
current = dates.getYear()+"-"+(dates.getMonth()+1<10?'0'+(dates.getMonth()+1):dates.getMonth())+"-"+ dates.getDate()<10?'0'+dates.getDate():dates.getDate() ;
first = dates.getYear()+"-"+(dates.getMonth()+1<10?'0'+(dates.getMonth()+1):dates.getMonth())+"-"+'01';
last = dates.getYear()+"-"+(dates.getMonth()+1<10?'0'+(dates.getMonth()+1):dates.getMonth())+"-"+'31';

function setF(departid,objid)
{
    if(departid==""){
          var obj = document.getElementById(objid);
          var length = obj.length;
          for (var j=length-1; j>0; j--)
          {
            obj.options.remove(j);
          }
    	  for(var i=1;i<person.length;i++){   
              var oOption = document.createElement("OPTION");
              obj.options.add(oOption);
              oOption.innerText = person[i].data[1];
              oOption.value = person[i].data[0];
          }	  
    }else{
      var obj = document.getElementById(objid);
      var length = obj.length;
      for (var j=length-1; j>0; j--)
      {
        obj.options.remove(j);
      }
         
      for(var i=0;i<person.length;i++){
        if(person[i].data[2]==departid){
          var oOption = document.createElement("OPTION");
          obj.options.add(oOption);
          oOption.innerText = person[i].data[1];
          oOption.value = person[i].data[0];
        }
      }
    }
}

function fsubmit()
{
   if(form1.factory.value!='') form1.facname.value=form1.factory.options[form1.factory.options.selectedIndex].innerText;
   if(form1.storname.value!='') form1.stor.value=form1.storname.options[form1.storname.options.selectedIndex].innerText;
   form1.submit();
}

function setVals(dm,mc,code) {
      setVal(dm,mc);
      form1.ptype.value=code;
      form1.ptypename.value=mc;
}

</script>
<body>	
<form name="form1" action="doselectouthistory.aspx" method="post" >
<table class="datatable" border="0" cellpadding="0" frame="box" cellspacing="0">
		<tr class="search"> 
			
			   <td class="tdlabel" width="10%">起始日期</td>
			<td class="tdinput" width="20%">
                       <script>
			document.write("<input type=text name=begintime size=10 readonly value='"+first+"'>");
                       </script>
			<img src="../../../images/common/datetime.gif" style="cursor:hand;" align="absmiddle" alt="弹出日历下拉菜单" onClick="fPopCalendar(begintime,begintime);return false">
			
			</td>	
			
			<td class="tdlabel" width="10%">结束日期</td>
			<td class="tdinput" width="20%">
			<script>
				document.write("<input type=text name=endtime size=10 readonly value='"+last+"'>");
			  </script>	
			<img src="../../../images/common/datetime.gif" style="cursor:hand;" align="absmiddle" alt="弹出日历下拉菜单" onClick="fPopCalendar(endtime,endtime);return false">

			</td>
			
			</td>	
                </tr>
		 
		<tr class="search"> 
			<td class="tdlabel" width="10%">生产分厂</td>
			<td class="tdinput" width="20%">
				<select name=factory onchange="javascript:setF(this.value,'storname');"><option value=''>请选择生产分厂</option>
                           #foreach ($name in $sql0)
				<option value="$name.PK_DEPTDOC" >$name.DEPTNAME</option>
                           #end
                                </select><input type="hidden" name="facname" value="">			
			</td>	
			<td class="tdlabel" width="10%">分厂仓库</td>
			<td class="tdinput" width="20%">
				<select name=storname><option value=''>请选择生产仓库</option>
                                </select><input type="hidden" name="stor" value="">
			</td>
                </tr>
		<tr class="search"> 
			<td class="tdlabel" width="10%">产品分类号</td>
			<td class="tdinput" width="20%">
				<input type="text" name="ptypename" value="">
				<input type="hidden" name="ptype" value="">
				<input type='button' name=bt class='btn' value='选择' onclick="click_on_tree_selector($F('ptypename'),$F('dm_zzjg_tree_layer'))">
				<div class="dtree" id="dm_zzjg_tree_layer" style="position:absolute;width:300px;height:208px;visibility:Hidden;z-index:1"> 
				<table width="100%" border="1" cellspacing="0" cellpadding="0" height="100%"><tr><td>
					<IFRAME style="width:100%;height:100%" name="swjgdm_tree_frame" marginWidth=0 marginHeight=0 src="class_tree.aspx" frameBorder=0 
						width="100%" height="100%" scrolling=auto BORDERCOLOR="#000000" ></IFRAME>
				</td></tr></table>
			        </div>
			        <script>
				   selector_layers[selector_layers.length]=document.all.dm_zzjg_tree_layer;
			        </script>				
			</td>	
			<td class="tdlabel" width="10%">产品名称</td>
			<td class="tdinput" width="20%">
				<input type="text" name="pname" value="">		
			</td>
                </tr>
                <tr>

                   <td class="tdlabel" width="10%">收发类别</td>
			<td class="tdinput" width="20%"  colspan='2'>
				<select name=indiscode><option value=''>请选择收发类别</option>
                           #foreach ($name in $sql2)
				<option value="$name.OUTDISCODE" >$name.OUTDISNAME</option>
                           #end
                                </select>		  		
			</td>
			
			<td align="center" >	
				<input type="button" name="search" class="bt1" value="查询" onclick="fsubmit()">&nbsp;<input type="button" name="search" class="bt1" value="取消" onclick="javascript:window.location='../syindex.htm'">	
			</td>
		</tr>	
		
</table>
</form>	
</body>
</html>
