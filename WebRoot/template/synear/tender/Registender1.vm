<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="stylesheet" type="text/css" href="../../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../../js/spellCode.css">
<script Language="JavaScript" src="../../../include/js/PopCalendar.js"></script>
<script Language="javascript" src="../../../include/js/public.js"></script>
<script Language="javascript" src="../../../include/js/string.js"></script>
<script  src="../../../inc/js/treePicker.js" language="javascript"></script>

<script src="../../../inc/js/pubjs.js"></script>
<script src="../../../inc/js/preAfter.js"></script>
<title>竞标用户注册</title>
<style type="text/css">
<!--
.STYLE1 {color: #FF0000}
-->
</style>
<script language="javascript">
        String.prototype.Trim = function() {  
	  var m = this.match(/^\s*(\S+(\s+\S+)*)\s*$/);  
	  return (m == null) ? "" : m[1];  
	}  
	String.prototype.isMobile = function() {  
	  return (/^(?:13\d|18\d|15\d)-?\d{5}(\d{3}|\*{3})$/.test(this.Trim()));  
	}  
	function ignoreSpaces(string) {
		var temp = "";
		string = '' + string;
		splitstring = string.split(" ");
		for(i = 0; i < splitstring.length; i++)
		temp += splitstring[i];
		return temp;
       }
	function checksub(){
		if(document.all.username.value == ""){
	             alert("供应商编码不能为空");
                     document.all.username.focus();
		     return false;
		}
		if(document.all.company.value == ""){
	             alert("公司名称不能为空");
                     document.all.company.focus();
		     return false;
		}
		if(document.all.companydesc.value == ""){
	             alert("公司介绍不能为空");
                     document.all.companydesc.focus();
		     return false;
		}
		if(document.all.companydress.value == ""){
	             alert("公司地址不能为空");
                     document.all.companydress.focus();
		     return false;
		}
		if(document.all.registermoney.value == ""){
	             /*alert("注册资金不能为空");
                     document.all.registermoney.focus();
		     return false;*/
		}else{
		     var re = /^[0-9]+.?[0-9]*$/;
		     if (!re.test(document.all.registermoney.value))
		     {
		        alert("注册资金不是数字");
		        document.all.registermoney.select();
		        return false;
		     }
		}
		if(document.all.enterprisecode.value == ""){
		     alert("所属公司不能为空");
                     document.all.enterprisecode.focus();
		     return false;
		}
		if(document.all.cnamea.value == ""){
	             alert("法人不能为空");
                     document.all.cnamea.focus();
		     return false;
		}
		if(document.all.cnameaphone.value == ""){
	             alert("联系人手机不能为空");
                     document.all.cnameaphone.focus();
		     return false;
		}else{
			if(document.all.cnameaphone.value.length!=11){
				alert("联系人手机不是11位");
				document.all.cnameaphone.select();
				return false;
			}else{
			     if (!document.all.cnameaphone.value.isMobile())  {  
			       alert("请输入正确的手机号码!");
			       document.all.cnameaphone.select();
			       return false;
			    }
			}
		}
		if(document.all.cnameatel.value == ""){
	             alert("联系人电话不能为空");
                     document.all.cnameatel.focus();
		     return false;
		}else{
		     if(document.all.cnameatel.value.length>12){
				alert("联系人电话不能大于12位");
				document.all.cnameatel.select();
				return false;
			}
		}
		if(document.all.cnameafax.value == ""){
	             alert("传真不能为空");
                     document.all.cnameafax.focus();
		     return false;
		}
		/*if(document.all.aemail.value == ""){
	             alert("EMAIL不能为空");
                     document.all.aemail.focus();
		     return false;
		}else{
		     if (document.all.aemail.value.search(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/) == -1){
			alert("EMAIL格式不正确");
			document.all.aemail.select();
			return false;
		     }
		}*/
		var b= new Date();
		document.all.userid.value=b.getTime();
		var datahtml="";
		if(document.form1.ptypeid2.value != ""){
			if(document.form1.ptypeid1.value != ""){
			    if(document.form1.ptypeid.value != ""){
				datahtml="<input type=hidden name=mantype1 value='"+document.form1.ptype2.value+"'><input type=hidden name=mantype1 value='"+document.form1.ptype1.value+"'><input type=hidden name=mantype1 value='"+document.form1.ptype.value+"'>";
			    }else{
				datahtml="<input type=hidden name=mantype1 value='"+document.form1.ptype2.value+"'><input type=hidden name=mantype1 value='"+document.form1.ptype1.value+"'>";
			    } 
			}else{
			    if(document.form1.ptypeid.value != ""){
                                 datahtml="<input type=hidden name=mantype1 value='"+document.form1.ptype2.value+"'><input type=hidden name=mantype1 value='"+document.form1.ptype.value+"'>";
			    }else{
			         datahtml="<input type=hidden name=mantype1 value='"+document.form1.ptype2.value+"'>";
			    }
			}
		}else{
			if(document.form1.ptypeid1.value != ""){
			    if(document.form1.ptypeid.value != ""){
				datahtml="<input type=hidden name=mantype1 value='"+document.form1.ptype1.value+"'><input type=hidden name=mantype1 value='"+document.form1.ptype.value+"'>";
			    }else{
				datahtml="<input type=hidden name=mantype1 value='"+document.form1.ptype1.value+"'>";
			    } 
			}else{
			    if(document.form1.ptypeid.value != ""){
                                 datahtml="<input type=hidden name=mantype1 value='"+document.form1.ptype.value+"'>";
			    }else{
				    alert("产品分类不能为空");
				    click_on_tree_selector($F('ptypename'),$F('dm_zzjg_tree_layer'));
				    return false;
		            }
			}
		}
		subdata.innerHTML=datahtml;
		if(document.form1.ishave.value != "2"){
		   document.form1.action="retistertendsub1.aspx";
		}else{
		   document.form1.action="retistertendsub2.aspx";
		}
	        document.form1.target="saveframe";
                form1.submit();
		
	}
	function testok()
	{  
	  document.form1.action="retistertendsub1.aspx";
	  //document.form1.target="saveframe";
	  form1.submit();
	}
	
	 function setVals(dm,mc,code) {
	      setVal(dm,mc);
	      form1.ptype.value=code;
	      form1.ptypename.value=mc;
	      form1.ptypeid.value=dm;
	}
	function setVals1(dm,mc,code) {
	      setVal1(dm,mc);
	      form1.ptype1.value=code;
	      form1.ptypename1.value=mc;
	      form1.ptypeid1.value=dm;
	}
	function setVals2(dm,mc,code) {
	      setVal2(dm,mc);
	      form1.ptype2.value=code;
	      form1.ptypename2.value=mc;
	      form1.ptypeid2.value=dm;
	}
	function upload(){
	      var ReturnProductValue=showModalDialog('fileUpload.jsp','','dialogWidth:500px;dialogHeight:300px;dialogLeft:280px;dialogTop:150px;center:yes; help:yes;resizable:yes;status:yes');
        }
       function checknewvendor(){
           document.form3.username1.value = document.form1.username.value;
           if(document.form3.username1.value==""){
	      alert("供应商编码不能为空");
	      return false;
	   }else{
              form3.action="testNewVendor.aspx";
	      form3.target="saveframe";
	      form3.submit();
	   }
       }
</script>
</head>

<body>
<form name="form2" action="registertend1.aspx" method="post">
    <table class="datatable">
	<tr>
	    <td align="center" colspan="7">供应商名称&nbsp;&nbsp;<input type="text" name="vname">&nbsp;&nbsp;<input type="submit" class="bt1" value="查询"></td>
	</tr>
	<tr class="trcolor">
	    <td>角色</td>
	    <td>供应商编码</td>
	    <td>供应商名称</td>
	    <td>公司名称</td>
	    <td>注册时间</td>
	    <td>添加人</td>
	    <td>是否通过审核</td>
	</tr>
	#set($i=0)
	#foreach($!m in $querytvendors)
	  <tr class="trcolor">
	    <td>$!m.ROLENAME &nbsp;</td>
	    <td>$!m.USERNAME &nbsp;</td>
	    <td>$!m.NAME &nbsp;</td>
	    <td>#if($!m.ROLEID == 'R9369')#else$!m.COMPANY#end &nbsp;</td>
	    <td>#if($!m.ROLEID == 'R9369')#else$!m.MAKETIME#end &nbsp;</td>
	    <td>#if($!m.ROLEID == 'R9369')#else$!m.ADDUSERNAME#end &nbsp;</td>
	    <td>
	       #if($!m.ROLEID == 'R9369')
	       #else
		       #if($!m.MAKESTATUS != "")
			  #if($!m.MAKESTATUS=='B')<font color='red'>是</font>#else否#end 
		       #end 
	       #end &nbsp;
	   </td>
	  </tr>
	  #set($i=$i+1)
	  #end
    </table>
</form>
<div>
<form name="form1" action="" method="post">
  <input type="hidden" name="tendtypeid" value="#foreach ($!n in $querybaseuserinfo)$!n.DEPT_ID#end">
  <input type="hidden" name="ishave" value="">
<table class="datatable">
  <tr class="trcolor">
    <td colspan="4" align="left">竞标用户注册
	<input type="hidden" name="userid" value="">
	<input type="hidden" name="userstatus" value="B">
    </td>
  </tr>
   <tr class="trcolor">
    <td align="right">供应商编码</td>
    <td align="left" colspan="3">
      <input type="text" name="username" onBlur="this.value=ignoreSpaces(this.value);" />
      <input type="button" name="checkvendor" class="bt1" value="检测供应商编码" onclick="checknewvendor()">
      <span class="STYLE1">*</span> </td>
  </tr>
  <tr class="trcolor">
    <td align="right">公司名称</td>
    <td align="left" colspan="3">
      <input type="text" name="company" />
      <span class="STYLE1">*</span> </td>
  </tr>
  <tr class="trcolor">
    <td align="right">公司简称</td>
    <td align="left" colspan="3">
      <input type="text" name="companysamp" />
    </td>
  </tr>
  <tr class="trcolor">
    <td align="right">公司介绍</td>
    <td align="left" colspan="3">
      <textarea name="companydesc"></textarea>
      <span class="STYLE1">*</span> </td>
  </tr>
  <tr class="trcolor">
    <td align="right">公司地址</td>
    <td align="left" colspan="3">
      <input type="text" name="companydress"/>
      <span class="STYLE1">*</span> </td>
  </tr>
  <tr class="trcolor">
    <td align="right">公司网址</td>
    <td align="left" colspan="3">
      <input type="text" name="companyinternet"/>
    </td>
  </tr>
  <tr class="trcolor">
    <td align="right">注册资金</td>
    <td align="left" colspan="3">
      <input type="text" name="registermoney"/>万元
      <span class="STYLE1">*</span> </td>
  </tr>
  <tr class="trcolor">
    <td align="right">所属公司</td>
    <td align="left" colspan="3">
      <select name="enterprisecode">
	   <option value=""></option>
	   #foreach($!h in $seltendtenterprisebyuser) 
		<option value="$!h.CHILDID">$!h.ENTERPRISENAME</option>
	   #end
	</select>
      <span class="STYLE1">*</span> </td>
  </tr>
  <tr class="trcolor">
    <td align="right">币种</td>
    <td align="left" colspan="3">
      <select name="currencicy"/>
	#foreach($!m in $querytendcurrency)
	   <option value="$!m.CURRENCYID">$!m.TYPENAME</option>
	#end
      </select>
      <span class="STYLE1">*</span> </td>
  </tr>
   <tr class="trcolor">
	<td class="tdlabel" width="10%">产品分类</td>
	<td class="tdinput" width="20%">
		<input type="text" name="ptypename" value="$!form_ptypename" readonly>
		<input type="hidden" name="ptype" value="$!form_ptype">
		<input type="hidden" name="ptypeid" value="$!form_ptypeid">
		<input type='button' name=bt class='bt1' value='选择' onclick="click_on_tree_selector($F('ptypename'),$F('dm_zzjg_tree_layer'))">
		<div class="dtree" id="dm_zzjg_tree_layer" style="position:absolute;width:260px;height:208px;visibility:Hidden;z-index:1"> 
		<table width="100%" border="1" cellspacing="0" cellpadding="0" height="100%"><tr><td>
			<IFRAME style="width:100%;height:100%" name="swjgdm_tree_frame" marginWidth=0 marginHeight=0 src="class_tree.aspx" frameBorder=0 
				width="100%" height="100%" scrolling=auto BORDERCOLOR="#000000" ></IFRAME>
		</td></tr></table>
		</div>
		<script>
		   selector_layers[selector_layers.length]=document.all.dm_zzjg_tree_layer;
		</script>
		<input type="button" value="清除" class="bt1" onclick="toclear()">
		<script language="javascript">
                    function toclear(){
			document.form1.ptypename.value="";
			document.form1.ptype.value="";
			document.form1.ptypeid.value="";
		    }
		</script>
	</td>
  </tr>
  <tr class="trcolor">
	<td class="tdlabel" width="10%"></td>
	<td class="tdinput" width="20%">
		<input type="text" name="ptypename1" value="$!form_ptypename1" readonly>
		<input type="hidden" name="ptype1" value="$!form_ptype1">
		<input type="hidden" name="ptypeid1" value="$!form_ptypeid1">
		<input type='button' name=bt class='bt1' value='选择' onclick="click_on_tree_selector1($F('ptypename1'),$F('dm_zzjg_tree_layer1'))">
		<div class="dtree" id="dm_zzjg_tree_layer1" style="position:absolute;width:260px;height:208px;visibility:Hidden;z-index:1"> 
		<table width="100%" border="1" cellspacing="0" cellpadding="0" height="100%"><tr><td>
			<IFRAME style="width:100%;height:100%" name="swjgdm_tree_frame" marginWidth=0 marginHeight=0 src="class_tree1.aspx" frameBorder=0 
				width="100%" height="100%" scrolling=auto BORDERCOLOR="#000000" ></IFRAME>
		</td></tr></table>
		</div>
		<script>
		   selector_layers[selector_layers.length]=document.all.dm_zzjg_tree_layer1;
		</script>
		<input type="button" value="清除" class="bt1" onclick="toclear1()">
		<script language="javascript">
                    function toclear1(){
			document.form1.ptypename1.value="";
			document.form1.ptype1.value="";
			document.form1.ptypeid1.value="";
		    }
		</script>
	</td>
  </tr>
  <tr class="trcolor">
	<td class="tdlabel" width="10%"></td>
	<td class="tdinput" width="20%">
		<input type="text" name="ptypename2" value="$!form_ptypename2" readonly>
		<input type="hidden" name="ptype2" value="$!form_ptype2">
		<input type="hidden" name="ptypeid2" value="$!form_ptypeid2">
		<input type='button' name=bt class='bt1' value='选择' onclick="click_on_tree_selector2($F('ptypename2'),$F('dm_zzjg_tree_layer2'))">
		<div class="dtree" id="dm_zzjg_tree_layer2" style="position:absolute;width:260px;height:208px;visibility:Hidden;z-index:1"> 
		<table width="100%" border="1" cellspacing="0" cellpadding="0" height="100%"><tr><td>
			<IFRAME style="width:100%;height:100%" name="swjgdm_tree_frame" marginWidth=0 marginHeight=0 src="class_tree2.aspx" frameBorder=0 
				width="100%" height="100%" scrolling=auto BORDERCOLOR="#000000" ></IFRAME>
		</td></tr></table>
		</div>
		<script>
		   selector_layers[selector_layers.length]=document.all.dm_zzjg_tree_layer2;
		</script>		
		<input type="button" value="清除" class="bt1" onclick="toclear2()">
		<script language="javascript">
                    function toclear2(){
			document.form1.ptypename2.value="";
			document.form1.ptype2.value="";
			document.form1.ptypeid2.value="";
		    }
		</script>
	</td>
  </tr>
  <tr class="trcolor">
    <td align="right">文件上传</td>
    <td colspan="3" align="left" >
    <input name="paper" type="text" size="40" value="" contenteditable="false"/>
		<input type="button" name="Submit22" class='bt1' value="文件上传" onClick="window.open('pfile.jsp?formname=form1&picurl=paper&type=userinfo&tendtypeid='+document.form1.tendtypeid.value,'','status=no,scrollbars=no,top=160,left=150,width=450,height=365')">
    </td>
  </tr>
  <td align="right">法人</td>
    <td colspan="3" align="left">
      <input type="text" name="cnamea"/>
      <span class="STYLE1">*</span></td>
  </tr>
  <tr>
    <td align="right">联系人手机</td>
    <td colspan="3" align="left">
      <input type="text" name="cnameaphone"/>
      <span class="STYLE1">*</span> </td>
  </tr> 
  <tr>
    <td align="right">联系人电话</td>
    <td align="left" colspan="3">
      <input type="text" name="cnameatel"/>
      <span class="STYLE1">*</span></td>
  </tr>
  <tr>
    <td align="right">传真</td>
    <td colspan="3" align="left">
      <input type="text" name="cnameafax"/>
      <span class="STYLE1">*</span> </td>
  </tr>
  <tr>
    <td align="right">EMAIL</td>
    <td colspan="3" align="left">
      <input type="text" name="aemail"/>
      <input type="hidden" name="password" value='E10ADC3949BA59ABBE56E057F20F883E'/>
      </td>
  </tr>
  <span id="subdata"></span>
  <tr class="trcolor">
    <td colspan="4">
      <input type="button" name="Submit2" class="bt1" value="提交" onclick="checksub()"/>
      <input type="reset" name="Submit" class="bt1" value="重置" /></td>
  </tr>
  </table>
</form>
</div>
<form name="form3" method="post">
  <input type="hidden" name="username1">
</form>
<iframe name="saveframe" src="about:blank" width="100%" height="0" noresize frameborder=0 framespacing=0 

marginheight=0 marginwidth=0></iframe> 
</body>
</html>