<HTML>
<HEAD>		
<title>出入库流水帐</title>
<link rel="stylesheet" type="text/css" href="../../js/style.css">
<link rel="stylesheet" type="text/css" href="../../js/spellCode.css">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<script Language="JavaScript" src="../../../include/js/PopCalendar.js"></script>
<script Language="javascript" src="../../../include/js/public.js"></script>
<script Language="javascript" src="../../../include/js/string.js"></script>
<script  src="../../../inc/js/treePicker.js" language="javascript"></script>

<script src="../../../inc/js/pubjs.js"></script>
<script src="../../../inc/js/preAfter.js"></script>
<style>
.changecolor{
font: 13px/200% 宋体;
}
.one{
 background:#fff;
 text-align:left;
}
.two{
 background:#eeeeee;
 text-align:left;
}
</style>
<SCRIPT LANGUAGE="JavaScript">
<!--
function set(id){
  var obj=eval("document.all."+id);
  var num=obj.rows.length-1
  for(var i=1;i<num;i++){
	if(i%2==1){
		obj.rows[i].className="one";
		}		
	else{
		obj.rows[i].className="two";
	}
  }
}

//查看
function ViewRow(obj,type)
{  

   obj = getParent(obj,"SPAN");
   var paras=obj.dtParams.split(",");
       document.form2.PID.value = paras[0];
       if("cartype" == type){
       document.form2.action="viewOutbill.aspx";
       }else{
        document.form2.action="viewOutbilltype.aspx";
       }
       document.form2.submit();
}
//打印
function ViewRow2(obj)
{  

   obj = getParent(obj,"SPAN");
   var paras=obj.dtParams.split(",");
       document.form2.PID.value = paras[0];
       document.form2.action="printOutbill.aspx";
       document.form2.submit();
}
//删除
function DelRow()
{      
alert("功能暂不开放");
return;
      var obj = window.event.srcElement;
	    obj = getParent(obj,"SPAN");
	   var paras=obj.dtParams.split(",");
  
     if(confirm('你确定要删除吗？'))
     {
	    
	   document.form1.PID.value = paras[0];
	   //document.form1.submit();
   }
}

function setVals(dm,mc,code) {
      setVal(dm,mc);
      thisform.ptype.value=code;
      thisform.ptypename.value=mc;
}

function clearVals() {
      thisform.ptype.value='';
      thisform.ptypename.value='';
}

function checkinput()
{  
  thisform.submit();
}

var dates = new Date(); 
current = dates.getYear()+"-"+(dates.getMonth()+1<10?'0'+(dates.getMonth()+1):dates.getMonth())+"-"+ (dates.getDate()<10?'0'+dates.getDate():dates.getDate()) ;
first = dates.getYear()+"-"+(dates.getMonth()+1<10?'0'+(dates.getMonth()+1):String(dates.getMonth()+1))+"-"+'01';
last = dates.getYear()+"-"+(dates.getMonth()+1<10?'0'+(dates.getMonth()+1):String(dates.getMonth()+1))+"-"+'31';

function ShowDate(idText){
 var state="dialogHeight: 300px; dialogWidth: 240px; dialogTop: 200px; dialogLeft: 300px; "+             "edge: Raised;  center: Yes; help: No; resizable: Yes; status: No;";

 var reValue=window.showModalDialog('../../../js/date.html?OpenForm',"myDate",state);
 if(reValue==null) 
   ;
 else
   idText.value=reValue;
 
 }

function init()
{
  #foreach($m in $getStockBegin)  //起初库存
	  try{
		 eval("document.all.QCJ${m.INVCODE}.innerText='$m.NNUM'");
		 eval("document.all.QCD${m.INVCODE}.innerText='$m.TNUM'");
	  }catch(e){}
	  alert(parseInt(document.all.QCJ.innerText))
	  try{
		 eval("document.all.QCJ.innerText=parseInt(document.all.QCJ.innerText)+parseInt('$m.NNUM')");
		 eval("document.all.QCD.innerText=parseFloat(document.all.QCD.innerText)+parseFloat('$m.NNUM')");
	  }catch(e){}
	  alert(parseInt(document.all.QCJ.innerText))
  #end
  #foreach($m in $getStockAllInF)  //入库
	  try{      
		 eval("document.all.SCJ${m.INVCODE}.innerText='$m.NNUM'");
		 eval("document.all.SCD${m.INVCODE}.innerText='$m.TNUM'");
	  }catch(e){}
	  try{
		 eval("document.all.SCJ.innerText=parseInt(document.all.SCJ.innerText)+parseInt('$m.NNUM')");
		 eval("document.all.SCD.innerText=parseFloat(document.all.SCD.innerText)+parseFloat('$m.NNUM')");
	  }catch(e){}
  #end
  #foreach($m in $getStockAllOutF)  //出库
	  try{      
		 eval("document.all.DBJ${m.INVCODE}.innerText='$m.NNUM'");
		 eval("document.all.DBD${m.INVCODE}.innerText='$m.TNUM'");
	  try{
		 eval("document.all.DBJ.innerText=parseInt(document.all.DBJ.innerText)+parseInt('$m.NNUM')");
		 eval("document.all.DBD.innerText=parseFloat(document.all.DBD.innerText)+parseFloat('$m.NNUM')");
	  }catch(e){}
	  }catch(e){}
  #end
  #foreach($m in $getStockEnd)  //期末
	  try{      
		 eval("document.all.QMJ${m.INVCODE}.innerText='$m.NNUM'");
		 eval("document.all.QMD${m.INVCODE}.innerText='$m.TNUM'");
	  }catch(e){}
	  try{
		 eval("document.all.QMJ.innerText=parseInt(document.all.QMJ.innerText)+parseInt('$m.NNUM')");
		 eval("document.all.QMD.innerText=parseFloat(document.all.QMD.innerText)+parseFloat('$m.NNUM')");
	  }catch(e){}
  #end
}
//-->
</SCRIPT>
</HEAD>
<BODY bgcolor="#E0F4FC" style="SCROLLBAR-HIGHLIGHT-COLOR:#73C5E8;SCROLLBAR-SHADOW-COLOR:#73C5E8;SCROLLBAR-3DLIGHT-

COLOR:#73C5E8;SCROLLBAR-TRACK-COLOR: #C2E8F8;SCROLLBAR-DARKSHADOW-COLOR:#73C5E8;scrollbar-Base-Color:#73C5E8;"  onload="init();">
<table border="0" cellspacing="0" cellpadding="0" width="100%" align="center">
<tr bgcolor="#E0F4FC" height="5"><td height="5"></td></tr>
<tr bgcolor="#E0F4FC"><td>
	<table border="0" cellspacing="0" cellpadding="0" width="98%" align="center" >
	  <tr height="23">
	    <td align=left height="20">
		   <table border="0" cellspacing="3" cellpadding="0">
		      <tr>
			     <td height=20>&nbsp;<div id="qx"></div></td>
			  </tr>
		   </table>
		</td>
		<td align="right">&nbsp;</td>
	   </tr>
      </table>
     </td>
</tr>
<tr>
  <form name="thisform" method="post">
   <td colspan=2>
      <table border="0" cellspacing="1" cellpadding="0" bgcolor="#ffffff" width="98%" align="center"  class="datatable">
      		      		<tr class="search"> 
			  <td class="tdlabel" width="10%">开始日期</td>
				<td class="tdinput" width="20%">
                         <input name="begintime" type="text" class="login" id="begintime" value="$!form_begintime" readonly><input type="button" value="↓" onClick="ShowDate(begintime);" class="button" name="button23" >
			</td>	
			
			<td class="tdlabel" width="10%">结束日期</td>
			<td class="tdinput" width="20%">
                         <input name="endtime" type="text" class="login" id="endtime" value="$!form_endtime" readonly><input type="button" value="↓" onClick="ShowDate(endtime);" class="button" name="button23" >
		</td>
			
			</td>	
                </tr>
		<tr class="search"> 
			<td class="tdlabel" width="10%">生产分厂</td>
			<td class="tdinput" width="20%">
				<select name=factory onchange="javascript:setF(this.value,'storname');"><option value=''>请选择生产分厂</option>
                           #foreach ($name in $getStockPur)
				<option value="$name.PK_UCODE"  #if($form_factory==$name.PK_UCODE) selected  #else unselected   #end>$name.UNAME</option>
                           #end
                                </select><input type="hidden" name="facname" value="">			
			</td>	
			<td class="tdlabel" width="10%">仓库</td>
			<td class="tdinput" width="20%">
				<select name=scode><option value=''>请选择仓库</option>
                           #foreach ($name in $getStorePur)
				<option value="$name.PK_SCODE"  #if($form_scode==$name.PK_SCODE) selected  #else unselected   #end>$name.SNAME</option>
                           #end
                                </select>		  		
			</td>
                </tr>
			<tr class="search"> 
			<td class="tdlabel" width="10%">产品分类号</td>
			<td class="tdinput" width="20%">
				<input type="text" name="ptypename" value="$!form_ptypename" readonly>
				<input type="hidden" name="ptype" value="$!form_ptype">
				<input type='button' name=bt class='btn' value='选择' onclick="click_on_tree_selector($F('ptypename'),$F('dm_zzjg_tree_layer'))">
				<div class="dtree" id="dm_zzjg_tree_layer" style="position:absolute;width:300px;height:208px;visibility:Hidden;z-index:1"> 
				<table width="100%" border="1" cellspacing="0" cellpadding="0" height="100%"><tr><td>
					<IFRAME style="width:100%;height:100%" name="swjgdm_tree_frame" marginWidth=0 marginHeight=0 src="class_tree.aspx" frameBorder=0 
						width="100%" height="100%" scrolling=auto BORDERCOLOR="#000000" ></IFRAME>
				</td></tr></table>
			        </div>
			        <script>
				   selector_layers[selector_layers.length]=document.all.dm_zzjg_tree_layer;
			        </script>				
			</td>	
			<td class="tdlabel" width="10%"></td>
			<td class="tdinput" width="20%">
						
			</td>
                </tr>

                <tr height="5" bgcolor="#A6DDF4"> 
		  <td colspan=4 height="5"></td>
		</tr>
		<tr bgcolor="#f3f3f3">
		  <td colspan=4 >
		  		<input type="button" name="submit1" value="搜 索" onclick="checkinput()" class="bt1">
                	</td>
		</tr>
		<tr>
		 <td colspan=5 height="0">
                     <!--iframe id="listframe" name="listframe" src="inOutData.aspx" width="0" height="0" noresize frameborder=0 framespacing=0 

marginheight=0 marginwidth=0></iframe--> 
		 </td>
		</tr>
	  </table>
   </td></form>
</tr>

</table>
<table border="0" cellspacing="0" cellpadding="0" bgcolor="#ffffff" width="98%" align="center" id="tb" class="datatable">
  <tr>
    <td width="60" rowspan="2" align="center" valign="bottom" class="size">产品编码</td>
    <td width="60" rowspan="2" align="center" valign="bottom" class="size">产品品称</td>
    <td width="60" rowspan="2" align="center" valign="bottom" class="size">产品规格</td>
    <td align="center" class="size">单件重</td>
    <td colspan="2" align="center" class="size">起初库存</td>
    <td colspan="2" align="center" class="size">本期生产</td>
    <td colspan="2" align="center" class="size">本期调拨</td>
    <td colspan="2" align="center" class="size">本期库存</td>
  </tr>
  <tr class="size">
     <td width="61" align="center" class="size">(T)</td>
     <td width="61" align="center" class="size">件数</td>
     <td width="61" align="center" class="size">吨位</td>
     <td width="61" align="center" class="size">件数</td>
     <td width="61" align="center" class="size">吨位</td>
     <td width="61" align="center" class="size">件数</td>
     <td width="61" align="center" class="size">吨位</td>
     <td width="61" align="center" class="size">件数</td>
     <td width="61" align="center" class="size">吨位</td>
  </tr>

  #foreach ($n in $getStockProd)
  <tr>
    <td>$n.ITEMCODE</td>
    <td>$n.ITEMDESC</td>
    <td>$n.ITEMSPEC</td>
    <td align="center">$n.WETNUM</td>
    <td align="center" id="QCJ${n.INVCODE}">&nbsp;</td>
    <td align="center" id="QCD${n.INVCODE}">&nbsp;</td>
    <td align="center" id="SCJ${n.INVCODE}">&nbsp;</td>
    <td align="center" id="SCD${n.INVCODE}">&nbsp;</td>
    <td align="center" id="DBJ${n.INVCODE}">&nbsp;</td>
    <td align="center" id="DBD${n.INVCODE}">&nbsp;</td>
    <td align="center" id="QMJ${n.INVCODE}">&nbsp;</td>
    <td align="center" id="QMD${n.INVCODE}">&nbsp;</td>
  </tr>
  #end
  <tr>
    <td colspan="4"  bgcolor="#eeeeee" align="center" class="trcolor">合计</td>
    <td align="center" id="QCJ">0</td>
    <td align="center" id="QCD">0</td>
    <td align="center" id="SCJ">0</td>
    <td align="center" id="SCD">0</td>
    <td align="center" id="DBJ">0</td>
    <td align="center" id="DBD">0</td>
    <td align="center" id="QMJ">0</td>
    <td align="center" id="QMD">0</td>
  </tr>
</table>


<form name="form1" method="post" action="delprod.aspx" target="saveframe">
  <input type="hidden" name="PID">
</form>

<form name="form2" method="post" action="viewOutbill.aspx">
   <input type="hidden" name="PID" value="">
</form>
<br>
</BODY>
</HTML>
